{"version":3,"sources":["../src/core/ImageState.ts","../src/core/OperationQueue.ts","../src/errors/ArtistAPhotoError.ts","../src/utils/canvas.ts","../src/core/ImageProcessor.ts","../src/utils/imageLoader.ts","../src/utils/validators.ts","../src/operations/base/Operation.ts","../src/operations/crop/CropOperation.ts","../src/operations/resize/ResizeOperation.ts","../src/operations/text/TextOperation.ts","../src/operations/shape/ShapeOperation.ts","../src/operations/filters/FilterOperation.ts","../src/operations/filters/GrayscaleFilter.ts","../src/utils/color.ts","../src/operations/filters/SepiaFilter.ts","../src/utils/matrix.ts","../src/operations/filters/BlurFilter.ts","../src/operations/filters/SharpenFilter.ts","../src/operations/filters/VintageFilter.ts","../src/operations/filters/InvertFilter.ts","../src/operations/filters/VignetteFilter.ts","../src/operations/filters/PosterizeFilter.ts","../src/operations/filters/PixelateFilter.ts","../src/operations/filters/EdgeDetectionFilter.ts","../src/operations/adjustments/BrightnessAdjustment.ts","../src/operations/adjustments/ContrastAdjustment.ts","../src/operations/adjustments/SaturationAdjustment.ts","../src/operations/adjustments/ExposureAdjustment.ts","../src/operations/adjustments/TemperatureAdjustment.ts","../src/core/ArtistAPhoto.ts","../src/index.ts","../src/workers/workerPool.ts"],"names":["ImageState","init_ImageState","__esmMin","_ImageState","image","imageData","OperationQueue","init_OperationQueue","operation","ArtistAPhotoError","InvalidDimensionsError","InvalidCropError","ImageLoadError","ExportError","CanvasContextError","init_ArtistAPhotoError","_ArtistAPhotoError","message","_InvalidDimensionsError","_InvalidCropError","_ImageLoadError","_ExportError","_CanvasContextError","createCanvas","width","height","canvas","getContext2D","ctx","canvasToBlob","format","quality","resolve","reject","blob","canvasToDataURL","downloadBlob","filename","url","link","init_canvas","ImageProcessor","init_ImageProcessor","state","operations","loadImageFromUrl","img","loadImageFromFile","file","getImageData","init_imageLoader","validateDimensions","MAX_DIMENSION","validateCropParams","params","imageWidth","imageHeight","x","y","validateAdjustmentValue","value","min","max","validateFilterIntensity","intensity","init_validators","BaseOperation","init_Operation","CropOperation","init_CropOperation","ResizeOperation","init_ResizeOperation","options","currentImage","tempCanvas","TextOperation","init_TextOperation","_canvas","fontStyle","fontWeight","ShapeOperation","init_ShapeOperation","centerX","centerY","radiusX","radiusY","FilterOperation","init_FilterOperation","data","GrayscaleFilter","init_GrayscaleFilter","i","gray","clamp","init_color","SepiaFilter","init_SepiaFilter","r","g","b","newR","newG","newB","convolve","kernel","kernelSize","result","half","ky","kx","pixelY","pixelX","pixelIndex","weight","index","BLUR_KERNEL_3X3","SHARPEN_KERNEL_3X3","SOBEL_X_KERNEL","SOBEL_Y_KERNEL","init_matrix","BlurFilter","init_BlurFilter","radius","blurred","SharpenFilter","init_SharpenFilter","sharpened","VintageFilter","init_VintageFilter","distance","maxDistance","vignette","InvertFilter","init_InvertFilter","VignetteFilter","init_VignetteFilter","strength","factor","originalR","originalG","originalB","PosterizeFilter","init_PosterizeFilter","levels","step","PixelateFilter","init_PixelateFilter","blockSize","original","avgColor","startX","startY","size","count","color","EdgeDetectionFilter","init_EdgeDetectionFilter","grayValue","gx","gy","kernelIndex","pixelValue","magnitude","BrightnessAdjustment","init_BrightnessAdjustment","adjustment","ContrastAdjustment","init_ContrastAdjustment","SaturationAdjustment","init_SaturationAdjustment","ExposureAdjustment","init_ExposureAdjustment","exposure","TemperatureAdjustment","init_TemperatureAdjustment","temp","ArtistAPhoto_exports","__export","ArtistAPhoto","init_ArtistAPhoto","_ArtistAPhoto","type","WorkerPool","maxWorkers","workerCode","worker","checkInterval","task","timeout","e","error","createEditor","source"],"mappings":"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","file":"index.global.js","sourcesContent":["import type { ImageMetadata } from '../types';\n\nexport class ImageState {\n  readonly originalImage: HTMLImageElement;\n  readonly originalImageData: ImageData;\n  readonly width: number;\n  readonly height: number;\n  readonly metadata: ImageMetadata;\n\n  constructor(image: HTMLImageElement, imageData: ImageData) {\n    this.originalImage = image;\n    this.originalImageData = imageData;\n    this.width = imageData.width;\n    this.height = imageData.height;\n    this.metadata = {\n      createdAt: Date.now(),\n      format: 'unknown',\n      width: imageData.width,\n      height: imageData.height,\n    };\n  }\n\n  clone(): ImageState {\n    return new ImageState(this.originalImage, this.originalImageData);\n  }\n}\n","import type { Operation } from '../operations/base/Operation';\n\nexport class OperationQueue {\n  private operations: Operation[] = [];\n  private currentIndex: number = -1;\n\n  enqueue(operation: Operation): void {\n    // Remove \"future\" operations if any when adding new operation\n    this.operations = this.operations.slice(0, this.currentIndex + 1);\n    this.operations.push(operation);\n    this.currentIndex++;\n  }\n\n  undo(): void {\n    if (this.canUndo()) {\n      this.currentIndex--;\n    }\n  }\n\n  redo(): void {\n    if (this.canRedo()) {\n      this.currentIndex++;\n    }\n  }\n\n  getActiveOperations(): ReadonlyArray<Operation> {\n    return this.operations.slice(0, this.currentIndex + 1);\n  }\n\n  getAllOperations(): ReadonlyArray<Operation> {\n    return this.operations;\n  }\n\n  canUndo(): boolean {\n    return this.currentIndex >= 0;\n  }\n\n  canRedo(): boolean {\n    return this.currentIndex < this.operations.length - 1;\n  }\n\n  clear(): void {\n    this.operations = [];\n    this.currentIndex = -1;\n  }\n\n  reset(): void {\n    this.currentIndex = -1;\n  }\n}\n","export class ArtistAPhotoError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'ArtistAPhotoError';\n    Object.setPrototypeOf(this, ArtistAPhotoError.prototype);\n  }\n}\n\nexport class InvalidDimensionsError extends ArtistAPhotoError {\n  constructor(message: string = 'Invalid dimensions') {\n    super(message);\n    this.name = 'InvalidDimensionsError';\n    Object.setPrototypeOf(this, InvalidDimensionsError.prototype);\n  }\n}\n\nexport class InvalidCropError extends ArtistAPhotoError {\n  constructor(message: string = 'Invalid crop parameters') {\n    super(message);\n    this.name = 'InvalidCropError';\n    Object.setPrototypeOf(this, InvalidCropError.prototype);\n  }\n}\n\nexport class ImageLoadError extends ArtistAPhotoError {\n  constructor(message: string = 'Failed to load image') {\n    super(message);\n    this.name = 'ImageLoadError';\n    Object.setPrototypeOf(this, ImageLoadError.prototype);\n  }\n}\n\nexport class ExportError extends ArtistAPhotoError {\n  constructor(message: string = 'Failed to export image') {\n    super(message);\n    this.name = 'ExportError';\n    Object.setPrototypeOf(this, ExportError.prototype);\n  }\n}\n\nexport class CanvasContextError extends ArtistAPhotoError {\n  constructor(message: string = 'Failed to get canvas context') {\n    super(message);\n    this.name = 'CanvasContextError';\n    Object.setPrototypeOf(this, CanvasContextError.prototype);\n  }\n}\n","import { CanvasContextError, ExportError } from '../errors/ArtistAPhotoError';\nimport type { ExportFormat } from '../types';\n\nexport function createCanvas(width: number, height: number): HTMLCanvasElement {\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  return canvas;\n}\n\nexport function getContext2D(canvas: HTMLCanvasElement): CanvasRenderingContext2D {\n  const ctx = canvas.getContext('2d', { willReadFrequently: true });\n  if (!ctx) {\n    throw new CanvasContextError('Failed to get 2D context');\n  }\n  return ctx;\n}\n\nexport function canvasToBlob(\n  canvas: HTMLCanvasElement,\n  format: ExportFormat = 'image/png',\n  quality?: number\n): Promise<Blob> {\n  return new Promise((resolve, reject) => {\n    canvas.toBlob(\n      (blob) => {\n        if (blob) {\n          resolve(blob);\n        } else {\n          reject(new ExportError('Failed to create blob from canvas'));\n        }\n      },\n      format,\n      quality\n    );\n  });\n}\n\nexport function canvasToDataURL(\n  canvas: HTMLCanvasElement,\n  format: ExportFormat = 'image/png',\n  quality?: number\n): string {\n  return canvas.toDataURL(format, quality);\n}\n\nexport function downloadBlob(blob: Blob, filename: string): void {\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n  URL.revokeObjectURL(url);\n}\n","import { createCanvas, getContext2D } from '../utils/canvas';\nimport type { ImageState } from './ImageState';\nimport type { Operation } from '../operations/base/Operation';\n\nexport class ImageProcessor {\n  private canvas: HTMLCanvasElement;\n  private ctx: CanvasRenderingContext2D;\n\n  constructor() {\n    this.canvas = createCanvas(1, 1);\n    this.ctx = getContext2D(this.canvas);\n  }\n\n  async execute(\n    state: ImageState,\n    operations: ReadonlyArray<Operation>\n  ): Promise<HTMLCanvasElement> {\n    // Set up canvas with original image\n    this.canvas.width = state.width;\n    this.canvas.height = state.height;\n    this.ctx.drawImage(state.originalImage, 0, 0);\n\n    // Apply operations sequentially\n    for (const operation of operations) {\n      await operation.apply(this.canvas, this.ctx);\n    }\n\n    return this.canvas;\n  }\n\n  getCanvas(): HTMLCanvasElement {\n    return this.canvas;\n  }\n\n  getContext(): CanvasRenderingContext2D {\n    return this.ctx;\n  }\n}\n","import { ImageLoadError } from '../errors/ArtistAPhotoError';\nimport { createCanvas, getContext2D } from './canvas';\n\nexport async function loadImageFromUrl(url: string): Promise<HTMLImageElement> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.onload = () => resolve(img);\n    img.onerror = () => reject(new ImageLoadError(`Failed to load image from ${url}`));\n    img.src = url;\n  });\n}\n\nexport async function loadImageFromFile(file: File): Promise<HTMLImageElement> {\n  const url = URL.createObjectURL(file);\n  try {\n    const img = await loadImageFromUrl(url);\n    return img;\n  } finally {\n    URL.revokeObjectURL(url);\n  }\n}\n\nexport function getImageData(img: HTMLImageElement): ImageData {\n  const canvas = createCanvas(img.width, img.height);\n  const ctx = getContext2D(canvas);\n  ctx.drawImage(img, 0, 0);\n  return ctx.getImageData(0, 0, img.width, img.height);\n}\n\nexport function imageDataToCanvas(imageData: ImageData): HTMLCanvasElement {\n  const canvas = createCanvas(imageData.width, imageData.height);\n  const ctx = getContext2D(canvas);\n  ctx.putImageData(imageData, 0, 0);\n  return canvas;\n}\n","import { InvalidDimensionsError, InvalidCropError } from '../errors/ArtistAPhotoError';\nimport type { CropOptions } from '../types';\n\nconst MAX_DIMENSION = 16384;\n\nexport function validateDimensions(width: number, height: number): void {\n  if (width <= 0 || height <= 0) {\n    throw new InvalidDimensionsError('Dimensions must be positive numbers');\n  }\n  if (width > MAX_DIMENSION || height > MAX_DIMENSION) {\n    throw new InvalidDimensionsError(\n      `Dimensions exceed maximum size (${MAX_DIMENSION}x${MAX_DIMENSION})`\n    );\n  }\n}\n\nexport function validateCropParams(\n  params: CropOptions,\n  imageWidth: number,\n  imageHeight: number\n): void {\n  const { x, y, width, height } = params;\n\n  if (x < 0 || y < 0) {\n    throw new InvalidCropError('Crop coordinates must be non-negative');\n  }\n  if (width <= 0 || height <= 0) {\n    throw new InvalidCropError('Crop dimensions must be positive');\n  }\n  if (x + width > imageWidth || y + height > imageHeight) {\n    throw new InvalidCropError('Crop area exceeds image bounds');\n  }\n}\n\nexport function validateAdjustmentValue(\n  value: number,\n  min: number = -100,\n  max: number = 100\n): number {\n  return Math.max(min, Math.min(max, value));\n}\n\nexport function validateFilterIntensity(intensity: number = 1.0): number {\n  return Math.max(0, Math.min(1, intensity));\n}\n","import type { OperationType, OperationParams } from '../../types';\n\nexport interface Operation {\n  readonly type: OperationType;\n  readonly params: OperationParams;\n\n  apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void>;\n  validate(): boolean;\n}\n\nexport abstract class BaseOperation implements Operation {\n  abstract readonly type: OperationType;\n  abstract readonly params: OperationParams;\n\n  abstract apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void>;\n\n  validate(): boolean {\n    return true;\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport type { CropOptions } from '../../types';\n\nexport class CropOperation extends BaseOperation {\n  readonly type = 'crop' as const;\n  readonly params: CropOptions;\n\n  constructor(params: CropOptions) {\n    super();\n    this.params = params;\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const { x, y, width, height } = this.params;\n\n    // Get cropped image data\n    const imageData = ctx.getImageData(x, y, width, height);\n\n    // Resize canvas to cropped dimensions\n    canvas.width = width;\n    canvas.height = height;\n\n    // Draw cropped image\n    ctx.putImageData(imageData, 0, 0);\n  }\n\n  validate(): boolean {\n    const { x, y, width, height } = this.params;\n    return x >= 0 && y >= 0 && width > 0 && height > 0;\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport { createCanvas, getContext2D } from '../../utils/canvas';\nimport type { ResizeParams, ResizeOptions } from '../../types';\n\nexport class ResizeOperation extends BaseOperation {\n  readonly type = 'resize' as const;\n  readonly params: ResizeParams;\n\n  constructor(width: number, height: number, options?: ResizeOptions) {\n    super();\n    this.params = {\n      width,\n      height,\n      quality: options?.quality || 'high',\n      maintainAspectRatio: options?.maintainAspectRatio ?? true,\n    };\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const { width, height, quality } = this.params;\n\n    // Store current image\n    const currentImage = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const tempCanvas = createCanvas(canvas.width, canvas.height);\n    const tempCtx = getContext2D(tempCanvas);\n    tempCtx.putImageData(currentImage, 0, 0);\n\n    // Resize canvas\n    canvas.width = width;\n    canvas.height = height;\n\n    // Set image smoothing based on quality\n    ctx.imageSmoothingEnabled = quality === 'high' || quality === 'medium';\n    ctx.imageSmoothingQuality = quality === 'high' ? 'high' : quality === 'medium' ? 'medium' : 'low';\n\n    // Draw resized image\n    ctx.drawImage(tempCanvas, 0, 0, width, height);\n  }\n\n  validate(): boolean {\n    const { width, height } = this.params;\n    return width > 0 && height > 0;\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport type { TextOptions, TextParams } from '../../types';\n\nexport class TextOperation extends BaseOperation {\n  readonly type = 'text' as const;\n  readonly params: TextParams;\n\n  constructor(options: TextOptions) {\n    super();\n    this.params = {\n      text: options.text,\n      x: options.x,\n      y: options.y,\n      fontSize: options.fontSize || 24,\n      fontFamily: options.fontFamily || 'Arial',\n      color: options.color || '#000000',\n      align: options.align || 'left',\n      baseline: options.baseline || 'alphabetic',\n      maxWidth: options.maxWidth || 0,\n      bold: options.bold || false,\n      italic: options.italic || false,\n      rotation: options.rotation || 0,\n      stroke: options.stroke,\n      shadow: options.shadow,\n    };\n  }\n\n  async apply(_canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    ctx.save();\n\n    // Apply rotation if needed\n    if (this.params.rotation !== 0) {\n      ctx.translate(this.params.x, this.params.y);\n      ctx.rotate((this.params.rotation * Math.PI) / 180);\n      ctx.translate(-this.params.x, -this.params.y);\n    }\n\n    // Configure font\n    const fontStyle = this.params.italic ? 'italic' : 'normal';\n    const fontWeight = this.params.bold ? 'bold' : 'normal';\n    ctx.font = `${fontStyle} ${fontWeight} ${this.params.fontSize}px ${this.params.fontFamily}`;\n    ctx.textAlign = this.params.align;\n    ctx.textBaseline = this.params.baseline;\n\n    // Apply shadow if provided\n    if (this.params.shadow) {\n      ctx.shadowColor = this.params.shadow.color;\n      ctx.shadowBlur = this.params.shadow.blur;\n      ctx.shadowOffsetX = this.params.shadow.offsetX;\n      ctx.shadowOffsetY = this.params.shadow.offsetY;\n    }\n\n    // Draw text stroke if provided\n    if (this.params.stroke) {\n      ctx.strokeStyle = this.params.stroke.color;\n      ctx.lineWidth = this.params.stroke.width;\n      if (this.params.maxWidth > 0) {\n        ctx.strokeText(this.params.text, this.params.x, this.params.y, this.params.maxWidth);\n      } else {\n        ctx.strokeText(this.params.text, this.params.x, this.params.y);\n      }\n    }\n\n    // Draw text fill\n    ctx.fillStyle = this.params.color;\n    if (this.params.maxWidth > 0) {\n      ctx.fillText(this.params.text, this.params.x, this.params.y, this.params.maxWidth);\n    } else {\n      ctx.fillText(this.params.text, this.params.x, this.params.y);\n    }\n\n    ctx.restore();\n  }\n\n  validate(): boolean {\n    return (\n      this.params.text.length > 0 &&\n      this.params.fontSize > 0 &&\n      this.params.x >= 0 &&\n      this.params.y >= 0\n    );\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport type { ShapeOptions, ShapeParams } from '../../types';\n\nexport class ShapeOperation extends BaseOperation {\n  readonly type = 'shape' as const;\n  readonly params: ShapeParams;\n\n  constructor(options: ShapeOptions) {\n    super();\n    this.params = {\n      type: options.type,\n      x: options.x,\n      y: options.y,\n      width: options.width,\n      height: options.height,\n      fill: options.fill,\n      stroke: options.stroke,\n      rotation: options.rotation || 0,\n    };\n  }\n\n  async apply(_canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    ctx.save();\n\n    // Apply rotation if needed\n    if (this.params.rotation !== 0) {\n      const centerX = this.params.x + this.params.width / 2;\n      const centerY = this.params.y + this.params.height / 2;\n      ctx.translate(centerX, centerY);\n      ctx.rotate((this.params.rotation * Math.PI) / 180);\n      ctx.translate(-centerX, -centerY);\n    }\n\n    // Draw shape based on type\n    if (this.params.type === 'rectangle') {\n      this.drawRectangle(ctx);\n    } else if (this.params.type === 'ellipse') {\n      this.drawEllipse(ctx);\n    }\n\n    ctx.restore();\n  }\n\n  private drawRectangle(ctx: CanvasRenderingContext2D): void {\n    // Draw fill if provided\n    if (this.params.fill) {\n      ctx.fillStyle = this.params.fill;\n      ctx.fillRect(this.params.x, this.params.y, this.params.width, this.params.height);\n    }\n\n    // Draw stroke if provided\n    if (this.params.stroke) {\n      ctx.strokeStyle = this.params.stroke.color;\n      ctx.lineWidth = this.params.stroke.width;\n      ctx.strokeRect(this.params.x, this.params.y, this.params.width, this.params.height);\n    }\n  }\n\n  private drawEllipse(ctx: CanvasRenderingContext2D): void {\n    const centerX = this.params.x + this.params.width / 2;\n    const centerY = this.params.y + this.params.height / 2;\n    const radiusX = this.params.width / 2;\n    const radiusY = this.params.height / 2;\n\n    ctx.beginPath();\n    ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, 2 * Math.PI);\n\n    // Draw fill if provided\n    if (this.params.fill) {\n      ctx.fillStyle = this.params.fill;\n      ctx.fill();\n    }\n\n    // Draw stroke if provided\n    if (this.params.stroke) {\n      ctx.strokeStyle = this.params.stroke.color;\n      ctx.lineWidth = this.params.stroke.width;\n      ctx.stroke();\n    }\n  }\n\n  validate(): boolean {\n    return (\n      this.params.width > 0 &&\n      this.params.height > 0 &&\n      this.params.x >= 0 &&\n      this.params.y >= 0 &&\n      (this.params.type === 'rectangle' || this.params.type === 'ellipse')\n    );\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport { validateFilterIntensity } from '../../utils/validators';\nimport type { FilterParams } from '../../types';\n\nexport abstract class FilterOperation extends BaseOperation {\n  readonly type = 'filter' as const;\n  protected intensity: number;\n  abstract readonly params: FilterParams;\n\n  constructor(intensity: number = 1.0) {\n    super();\n    this.intensity = validateFilterIntensity(intensity);\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const data = imageData.data;\n\n    // Apply filter to each pixel\n    this.applyFilter(data, canvas.width, canvas.height);\n\n    ctx.putImageData(imageData, 0, 0);\n  }\n\n  protected abstract applyFilter(\n    data: Uint8ClampedArray,\n    width: number,\n    height: number\n  ): void;\n}\n","import { FilterOperation } from './FilterOperation';\nimport type { FilterParams } from '../../types';\n\nexport class GrayscaleFilter extends FilterOperation {\n  readonly params: FilterParams = { filterType: 'grayscale' };\n\n  constructor(intensity: number = 1.0) {\n    super(intensity);\n    this.params = { filterType: 'grayscale', intensity: this.intensity };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray): void {\n    for (let i = 0; i < data.length; i += 4) {\n      // Luminance formula: 0.299R + 0.587G + 0.114B\n      const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;\n\n      // Apply intensity (blend with original)\n      data[i] = data[i] * (1 - this.intensity) + gray * this.intensity;\n      data[i + 1] = data[i + 1] * (1 - this.intensity) + gray * this.intensity;\n      data[i + 2] = data[i + 2] * (1 - this.intensity) + gray * this.intensity;\n    }\n  }\n}\n","export function rgbToHsl(r: number, g: number, b: number): [number, number, number] {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  let h = 0;\n  let s = 0;\n  const l = (max + min) / 2;\n\n  if (max !== min) {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r:\n        h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\n        break;\n      case g:\n        h = ((b - r) / d + 2) / 6;\n        break;\n      case b:\n        h = ((r - g) / d + 4) / 6;\n        break;\n    }\n  }\n\n  return [h * 360, s * 100, l * 100];\n}\n\nexport function hslToRgb(h: number, s: number, l: number): [number, number, number] {\n  h /= 360;\n  s /= 100;\n  l /= 100;\n\n  let r: number, g: number, b: number;\n\n  if (s === 0) {\n    r = g = b = l;\n  } else {\n    const hue2rgb = (p: number, q: number, t: number): number => {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n}\n\nexport function clamp(value: number, min: number = 0, max: number = 255): number {\n  return Math.max(min, Math.min(max, value));\n}\n","import { FilterOperation } from './FilterOperation';\nimport { clamp } from '../../utils/color';\nimport type { FilterParams } from '../../types';\n\nexport class SepiaFilter extends FilterOperation {\n  readonly params: FilterParams = { filterType: 'sepia' };\n\n  constructor(intensity: number = 1.0) {\n    super(intensity);\n    this.params = { filterType: 'sepia', intensity: this.intensity };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray): void {\n    for (let i = 0; i < data.length; i += 4) {\n      const r = data[i];\n      const g = data[i + 1];\n      const b = data[i + 2];\n\n      // Sepia transformation matrix\n      const newR = r * 0.393 + g * 0.769 + b * 0.189;\n      const newG = r * 0.349 + g * 0.686 + b * 0.168;\n      const newB = r * 0.272 + g * 0.534 + b * 0.131;\n\n      // Apply intensity (blend with original)\n      data[i] = clamp(data[i] * (1 - this.intensity) + newR * this.intensity);\n      data[i + 1] = clamp(data[i + 1] * (1 - this.intensity) + newG * this.intensity);\n      data[i + 2] = clamp(data[i + 2] * (1 - this.intensity) + newB * this.intensity);\n    }\n  }\n}\n","export function convolve(\n  data: Uint8ClampedArray,\n  width: number,\n  height: number,\n  kernel: number[],\n  kernelSize: number\n): Uint8ClampedArray {\n  const result = new Uint8ClampedArray(data.length);\n  const half = Math.floor(kernelSize / 2);\n\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n      let r = 0,\n        g = 0,\n        b = 0;\n\n      for (let ky = 0; ky < kernelSize; ky++) {\n        for (let kx = 0; kx < kernelSize; kx++) {\n          const pixelY = Math.min(height - 1, Math.max(0, y + ky - half));\n          const pixelX = Math.min(width - 1, Math.max(0, x + kx - half));\n          const pixelIndex = (pixelY * width + pixelX) * 4;\n          const weight = kernel[ky * kernelSize + kx];\n\n          r += data[pixelIndex] * weight;\n          g += data[pixelIndex + 1] * weight;\n          b += data[pixelIndex + 2] * weight;\n        }\n      }\n\n      const index = (y * width + x) * 4;\n      result[index] = Math.max(0, Math.min(255, r));\n      result[index + 1] = Math.max(0, Math.min(255, g));\n      result[index + 2] = Math.max(0, Math.min(255, b));\n      result[index + 3] = data[index + 3]; // Preserve alpha\n    }\n  }\n\n  return result;\n}\n\nexport const BLUR_KERNEL_3X3 = [1 / 16, 2 / 16, 1 / 16, 2 / 16, 4 / 16, 2 / 16, 1 / 16, 2 / 16, 1 / 16];\n\nexport const SHARPEN_KERNEL_3X3 = [0, -1, 0, -1, 5, -1, 0, -1, 0];\n\nexport const SOBEL_X_KERNEL = [-1, 0, 1, -2, 0, 2, -1, 0, 1];\n\nexport const SOBEL_Y_KERNEL = [-1, -2, -1, 0, 0, 0, 1, 2, 1];\n","import { FilterOperation } from './FilterOperation';\nimport { convolve, BLUR_KERNEL_3X3 } from '../../utils/matrix';\nimport type { BlurParams } from '../../types';\n\nexport class BlurFilter extends FilterOperation {\n  readonly params: BlurParams;\n\n  constructor(intensity: number = 1.0, radius: number = 1) {\n    super(intensity);\n    this.params = { filterType: 'blur', intensity: this.intensity, radius };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray, width: number, height: number): void {\n    // Apply Gaussian blur using convolution\n    const blurred = convolve(data, width, height, BLUR_KERNEL_3X3, 3);\n\n    // Apply intensity (blend with original)\n    for (let i = 0; i < data.length; i++) {\n      if ((i + 1) % 4 !== 0) {\n        // Skip alpha channel\n        data[i] = data[i] * (1 - this.intensity) + blurred[i] * this.intensity;\n      }\n    }\n  }\n}\n","import { FilterOperation } from './FilterOperation';\nimport { convolve, SHARPEN_KERNEL_3X3 } from '../../utils/matrix';\nimport type { SharpenParams } from '../../types';\n\nexport class SharpenFilter extends FilterOperation {\n  readonly params: SharpenParams;\n\n  constructor(intensity: number = 1.0) {\n    super(intensity);\n    this.params = { filterType: 'sharpen', intensity: this.intensity };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray, width: number, height: number): void {\n    // Apply sharpen using convolution\n    const sharpened = convolve(data, width, height, SHARPEN_KERNEL_3X3, 3);\n\n    // Apply intensity (blend with original)\n    for (let i = 0; i < data.length; i++) {\n      if ((i + 1) % 4 !== 0) {\n        // Skip alpha channel\n        data[i] = data[i] * (1 - this.intensity) + sharpened[i] * this.intensity;\n      }\n    }\n  }\n}\n","import { FilterOperation } from './FilterOperation';\nimport { clamp } from '../../utils/color';\nimport type { FilterParams } from '../../types';\n\nexport class VintageFilter extends FilterOperation {\n  readonly params: FilterParams;\n\n  constructor(intensity: number = 1.0) {\n    super(intensity);\n    this.params = { filterType: 'vintage', intensity: this.intensity };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray, width: number, height: number): void {\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const i = (y * width + x) * 4;\n        const r = data[i];\n        const g = data[i + 1];\n        const b = data[i + 2];\n\n        // Warm sepia-like tone\n        let newR = r * 0.9 + 30;\n        let newG = g * 0.85 + 10;\n        let newB = b * 0.7;\n\n        // Reduce saturation slightly\n        const gray = (newR + newG + newB) / 3;\n        newR = newR * 0.8 + gray * 0.2;\n        newG = newG * 0.8 + gray * 0.2;\n        newB = newB * 0.8 + gray * 0.2;\n\n        // Apply vignette (darker at edges)\n        const centerX = width / 2;\n        const centerY = height / 2;\n        const distance = Math.sqrt(Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2));\n        const maxDistance = Math.sqrt(Math.pow(centerX, 2) + Math.pow(centerY, 2));\n        const vignette = 1 - (distance / maxDistance) * 0.5;\n\n        newR *= vignette;\n        newG *= vignette;\n        newB *= vignette;\n\n        // Apply intensity (blend with original)\n        data[i] = clamp(data[i] * (1 - this.intensity) + newR * this.intensity);\n        data[i + 1] = clamp(data[i + 1] * (1 - this.intensity) + newG * this.intensity);\n        data[i + 2] = clamp(data[i + 2] * (1 - this.intensity) + newB * this.intensity);\n      }\n    }\n  }\n}\n","import { FilterOperation } from './FilterOperation';\nimport type { FilterParams } from '../../types';\n\nexport class InvertFilter extends FilterOperation {\n  readonly params: FilterParams = { filterType: 'invert' };\n\n  constructor(intensity: number = 1.0) {\n    super(intensity);\n    this.params = { filterType: 'invert', intensity: this.intensity };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray): void {\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = data[i] * (1 - this.intensity) + (255 - data[i]) * this.intensity;\n      data[i + 1] = data[i + 1] * (1 - this.intensity) + (255 - data[i + 1]) * this.intensity;\n      data[i + 2] = data[i + 2] * (1 - this.intensity) + (255 - data[i + 2]) * this.intensity;\n    }\n  }\n}\n","import { FilterOperation } from './FilterOperation';\nimport type { VignetteParams } from '../../types';\n\nexport class VignetteFilter extends FilterOperation {\n  readonly params: VignetteParams;\n\n  constructor(intensity: number = 1.0, strength: number = 0.5) {\n    super(intensity);\n    this.params = {\n      filterType: 'vignette',\n      intensity: this.intensity,\n      strength: Math.max(0, Math.min(1, strength)),\n    };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray, width: number, height: number): void {\n    const centerX = width / 2;\n    const centerY = height / 2;\n    const maxDistance = Math.sqrt(centerX * centerX + centerY * centerY);\n    const strength = this.params.strength || 0.5;\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const distance = Math.sqrt(Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2));\n        const vignette = 1 - (distance / maxDistance) * strength;\n        const factor = Math.max(0, Math.min(1, vignette));\n\n        const index = (y * width + x) * 4;\n        const originalR = data[index];\n        const originalG = data[index + 1];\n        const originalB = data[index + 2];\n\n        // Apply vignette with intensity\n        data[index] = originalR * (1 - this.intensity) + originalR * factor * this.intensity;\n        data[index + 1] = originalG * (1 - this.intensity) + originalG * factor * this.intensity;\n        data[index + 2] = originalB * (1 - this.intensity) + originalB * factor * this.intensity;\n      }\n    }\n  }\n}\n","import { FilterOperation } from './FilterOperation';\nimport { clamp } from '../../utils/color';\nimport type { PosterizeParams } from '../../types';\n\nexport class PosterizeFilter extends FilterOperation {\n  readonly params: PosterizeParams;\n\n  constructor(intensity: number = 1.0, levels: number = 4) {\n    super(intensity);\n    this.params = {\n      filterType: 'posterize',\n      intensity: this.intensity,\n      levels: Math.max(2, Math.min(16, Math.floor(levels))),\n    };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray): void {\n    const levels = this.params.levels || 4;\n    const step = 255 / (levels - 1);\n\n    for (let i = 0; i < data.length; i += 4) {\n      const r = data[i];\n      const g = data[i + 1];\n      const b = data[i + 2];\n\n      // Quantize each channel\n      const newR = Math.round(r / step) * step;\n      const newG = Math.round(g / step) * step;\n      const newB = Math.round(b / step) * step;\n\n      // Apply intensity (blend with original)\n      data[i] = clamp(data[i] * (1 - this.intensity) + newR * this.intensity);\n      data[i + 1] = clamp(data[i + 1] * (1 - this.intensity) + newG * this.intensity);\n      data[i + 2] = clamp(data[i + 2] * (1 - this.intensity) + newB * this.intensity);\n    }\n  }\n}\n","import { FilterOperation } from './FilterOperation';\nimport type { PixelateParams } from '../../types';\n\nexport class PixelateFilter extends FilterOperation {\n  readonly params: PixelateParams;\n\n  constructor(intensity: number = 1.0, blockSize: number = 10) {\n    super(intensity);\n    this.params = {\n      filterType: 'pixelate',\n      intensity: this.intensity,\n      blockSize: Math.max(1, Math.floor(blockSize)),\n    };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray, width: number, height: number): void {\n    const blockSize = this.params.blockSize || 10;\n    const original = new Uint8ClampedArray(data);\n\n    for (let y = 0; y < height; y += blockSize) {\n      for (let x = 0; x < width; x += blockSize) {\n        // Calculate average color of the block\n        const avgColor = this.getBlockAverage(original, x, y, blockSize, width, height);\n\n        // Fill block with average color\n        this.fillBlock(data, original, x, y, blockSize, width, height, avgColor);\n      }\n    }\n  }\n\n  private getBlockAverage(\n    data: Uint8ClampedArray,\n    startX: number,\n    startY: number,\n    size: number,\n    width: number,\n    height: number\n  ): [number, number, number] {\n    let r = 0,\n      g = 0,\n      b = 0,\n      count = 0;\n\n    for (let y = startY; y < Math.min(startY + size, height); y++) {\n      for (let x = startX; x < Math.min(startX + size, width); x++) {\n        const index = (y * width + x) * 4;\n        r += data[index];\n        g += data[index + 1];\n        b += data[index + 2];\n        count++;\n      }\n    }\n\n    return [Math.round(r / count), Math.round(g / count), Math.round(b / count)];\n  }\n\n  private fillBlock(\n    data: Uint8ClampedArray,\n    original: Uint8ClampedArray,\n    startX: number,\n    startY: number,\n    size: number,\n    width: number,\n    height: number,\n    color: [number, number, number]\n  ): void {\n    const [r, g, b] = color;\n\n    for (let y = startY; y < Math.min(startY + size, height); y++) {\n      for (let x = startX; x < Math.min(startX + size, width); x++) {\n        const index = (y * width + x) * 4;\n\n        // Apply intensity (blend with original)\n        data[index] = original[index] * (1 - this.intensity) + r * this.intensity;\n        data[index + 1] = original[index + 1] * (1 - this.intensity) + g * this.intensity;\n        data[index + 2] = original[index + 2] * (1 - this.intensity) + b * this.intensity;\n      }\n    }\n  }\n}\n","import { FilterOperation } from './FilterOperation';\nimport { SOBEL_X_KERNEL, SOBEL_Y_KERNEL } from '../../utils/matrix';\nimport { clamp } from '../../utils/color';\nimport type { FilterParams } from '../../types';\n\nexport class EdgeDetectionFilter extends FilterOperation {\n  readonly params: FilterParams;\n\n  constructor(intensity: number = 1.0) {\n    super(intensity);\n    this.params = { filterType: 'edgeDetection', intensity: this.intensity };\n  }\n\n  protected applyFilter(data: Uint8ClampedArray, width: number, height: number): void {\n    // Convert to grayscale first\n    const gray = new Uint8ClampedArray(data.length);\n    for (let i = 0; i < data.length; i += 4) {\n      const grayValue = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;\n      gray[i] = gray[i + 1] = gray[i + 2] = grayValue;\n      gray[i + 3] = data[i + 3];\n    }\n\n    // Apply Sobel operator\n    const result = this.applySobel(gray, width, height);\n\n    // Apply intensity (blend with original)\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = data[i] * (1 - this.intensity) + result[i] * this.intensity;\n      data[i + 1] = data[i + 1] * (1 - this.intensity) + result[i + 1] * this.intensity;\n      data[i + 2] = data[i + 2] * (1 - this.intensity) + result[i + 2] * this.intensity;\n    }\n  }\n\n  private applySobel(data: Uint8ClampedArray, width: number, height: number): Uint8ClampedArray {\n    const result = new Uint8ClampedArray(data.length);\n\n    for (let y = 1; y < height - 1; y++) {\n      for (let x = 1; x < width - 1; x++) {\n        let gx = 0;\n        let gy = 0;\n\n        // Apply Sobel kernels\n        for (let ky = -1; ky <= 1; ky++) {\n          for (let kx = -1; kx <= 1; kx++) {\n            const pixelIndex = ((y + ky) * width + (x + kx)) * 4;\n            const kernelIndex = (ky + 1) * 3 + (kx + 1);\n            const pixelValue = data[pixelIndex];\n\n            gx += pixelValue * SOBEL_X_KERNEL[kernelIndex];\n            gy += pixelValue * SOBEL_Y_KERNEL[kernelIndex];\n          }\n        }\n\n        // Calculate magnitude\n        const magnitude = Math.sqrt(gx * gx + gy * gy);\n        const index = (y * width + x) * 4;\n\n        result[index] = result[index + 1] = result[index + 2] = clamp(magnitude);\n        result[index + 3] = data[index + 3]; // Preserve alpha\n      }\n    }\n\n    return result;\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport { validateAdjustmentValue } from '../../utils/validators';\nimport { clamp } from '../../utils/color';\nimport type { AdjustmentParams } from '../../types';\n\nexport class BrightnessAdjustment extends BaseOperation {\n  readonly type = 'adjustment' as const;\n  readonly params: AdjustmentParams;\n\n  constructor(value: number) {\n    super();\n    this.params = {\n      adjustment: 'brightness',\n      value: validateAdjustmentValue(value),\n    };\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const data = imageData.data;\n    const adjustment = this.params.value * 2.55; // Convert to 0-255 scale\n\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = clamp(data[i] + adjustment);\n      data[i + 1] = clamp(data[i + 1] + adjustment);\n      data[i + 2] = clamp(data[i + 2] + adjustment);\n    }\n\n    ctx.putImageData(imageData, 0, 0);\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport { validateAdjustmentValue } from '../../utils/validators';\nimport { clamp } from '../../utils/color';\nimport type { AdjustmentParams } from '../../types';\n\nexport class ContrastAdjustment extends BaseOperation {\n  readonly type = 'adjustment' as const;\n  readonly params: AdjustmentParams;\n\n  constructor(value: number) {\n    super();\n    this.params = {\n      adjustment: 'contrast',\n      value: validateAdjustmentValue(value),\n    };\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const data = imageData.data;\n\n    // Convert value to contrast factor: -100 to 100 -> 0 to 2+\n    const factor = (259 * (this.params.value + 255)) / (255 * (259 - this.params.value));\n\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = clamp(factor * (data[i] - 128) + 128);\n      data[i + 1] = clamp(factor * (data[i + 1] - 128) + 128);\n      data[i + 2] = clamp(factor * (data[i + 2] - 128) + 128);\n    }\n\n    ctx.putImageData(imageData, 0, 0);\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport { validateAdjustmentValue } from '../../utils/validators';\nimport { clamp } from '../../utils/color';\nimport type { AdjustmentParams } from '../../types';\n\nexport class SaturationAdjustment extends BaseOperation {\n  readonly type = 'adjustment' as const;\n  readonly params: AdjustmentParams;\n\n  constructor(value: number) {\n    super();\n    this.params = {\n      adjustment: 'saturation',\n      value: validateAdjustmentValue(value),\n    };\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const data = imageData.data;\n\n    // Convert to saturation factor: -100 to 100 -> 0 to 2\n    const factor = (this.params.value + 100) / 100;\n\n    for (let i = 0; i < data.length; i += 4) {\n      const r = data[i];\n      const g = data[i + 1];\n      const b = data[i + 2];\n\n      // Convert to grayscale for luminance\n      const gray = 0.299 * r + 0.587 * g + 0.114 * b;\n\n      // Adjust saturation\n      data[i] = clamp(gray + factor * (r - gray));\n      data[i + 1] = clamp(gray + factor * (g - gray));\n      data[i + 2] = clamp(gray + factor * (b - gray));\n    }\n\n    ctx.putImageData(imageData, 0, 0);\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport { validateAdjustmentValue } from '../../utils/validators';\nimport { clamp } from '../../utils/color';\nimport type { AdjustmentParams } from '../../types';\n\nexport class ExposureAdjustment extends BaseOperation {\n  readonly type = 'adjustment' as const;\n  readonly params: AdjustmentParams;\n\n  constructor(value: number) {\n    super();\n    this.params = {\n      adjustment: 'exposure',\n      value: validateAdjustmentValue(value),\n    };\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const data = imageData.data;\n\n    // Exposure adjustment using gamma correction\n    const exposure = this.params.value / 100; // -1 to 1\n    const factor = Math.pow(2, exposure);\n\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = clamp(data[i] * factor);\n      data[i + 1] = clamp(data[i + 1] * factor);\n      data[i + 2] = clamp(data[i + 2] * factor);\n    }\n\n    ctx.putImageData(imageData, 0, 0);\n  }\n}\n","import { BaseOperation } from '../base/Operation';\nimport { validateAdjustmentValue } from '../../utils/validators';\nimport { clamp } from '../../utils/color';\nimport type { AdjustmentParams } from '../../types';\n\nexport class TemperatureAdjustment extends BaseOperation {\n  readonly type = 'adjustment' as const;\n  readonly params: AdjustmentParams;\n\n  constructor(value: number) {\n    super();\n    this.params = {\n      adjustment: 'temperature',\n      value: validateAdjustmentValue(value),\n    };\n  }\n\n  async apply(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D): Promise<void> {\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    const data = imageData.data;\n\n    const temp = this.params.value / 100; // -1 to 1\n\n    for (let i = 0; i < data.length; i += 4) {\n      if (temp > 0) {\n        // Warmer: increase red, decrease blue\n        data[i] = clamp(data[i] + temp * 40);\n        data[i + 2] = clamp(data[i + 2] - temp * 40);\n      } else {\n        // Cooler: decrease red, increase blue\n        data[i] = clamp(data[i] + temp * 40);\n        data[i + 2] = clamp(data[i + 2] - temp * 40);\n      }\n    }\n\n    ctx.putImageData(imageData, 0, 0);\n  }\n}\n","import { ImageState } from './ImageState';\nimport { OperationQueue } from './OperationQueue';\nimport { ImageProcessor } from './ImageProcessor';\nimport { loadImageFromUrl, loadImageFromFile, getImageData } from '../utils/imageLoader';\nimport { canvasToBlob, canvasToDataURL, downloadBlob } from '../utils/canvas';\nimport { validateCropParams, validateDimensions } from '../utils/validators';\nimport { CropOperation } from '../operations/crop/CropOperation';\nimport { ResizeOperation } from '../operations/resize/ResizeOperation';\nimport { TextOperation } from '../operations/text/TextOperation';\nimport { ShapeOperation } from '../operations/shape/ShapeOperation';\nimport { GrayscaleFilter } from '../operations/filters/GrayscaleFilter';\nimport { SepiaFilter } from '../operations/filters/SepiaFilter';\nimport { BlurFilter } from '../operations/filters/BlurFilter';\nimport { SharpenFilter } from '../operations/filters/SharpenFilter';\nimport { VintageFilter } from '../operations/filters/VintageFilter';\nimport { InvertFilter } from '../operations/filters/InvertFilter';\nimport { VignetteFilter } from '../operations/filters/VignetteFilter';\nimport { PosterizeFilter } from '../operations/filters/PosterizeFilter';\nimport { PixelateFilter } from '../operations/filters/PixelateFilter';\nimport { EdgeDetectionFilter } from '../operations/filters/EdgeDetectionFilter';\nimport { BrightnessAdjustment } from '../operations/adjustments/BrightnessAdjustment';\nimport { ContrastAdjustment } from '../operations/adjustments/ContrastAdjustment';\nimport { SaturationAdjustment } from '../operations/adjustments/SaturationAdjustment';\nimport { ExposureAdjustment } from '../operations/adjustments/ExposureAdjustment';\nimport { TemperatureAdjustment } from '../operations/adjustments/TemperatureAdjustment';\nimport type { Operation } from '../operations/base/Operation';\nimport type {\n  CropOptions,\n  ResizeOptions,\n  FilterType,\n  ExportFormat,\n  TextOptions,\n  ShapeOptions,\n} from '../types';\n\nexport class ArtistAPhoto {\n  private state: ImageState;\n  private operationQueue: OperationQueue;\n  private processor: ImageProcessor;\n\n  private constructor(state: ImageState) {\n    this.state = state;\n    this.operationQueue = new OperationQueue();\n    this.processor = new ImageProcessor();\n  }\n\n  // ==================== Factory Methods ====================\n\n  static async fromUrl(url: string): Promise<ArtistAPhoto> {\n    const img = await loadImageFromUrl(url);\n    const imageData = getImageData(img);\n    const state = new ImageState(img, imageData);\n    return new ArtistAPhoto(state);\n  }\n\n  static async fromFile(file: File): Promise<ArtistAPhoto> {\n    const img = await loadImageFromFile(file);\n    const imageData = getImageData(img);\n    const state = new ImageState(img, imageData);\n    return new ArtistAPhoto(state);\n  }\n\n  static async fromCanvas(canvas: HTMLCanvasElement): Promise<ArtistAPhoto> {\n    const img = new Image();\n    img.src = canvas.toDataURL();\n    await new Promise((resolve) => (img.onload = resolve));\n    const imageData = getImageData(img);\n    const state = new ImageState(img, imageData);\n    return new ArtistAPhoto(state);\n  }\n\n  static async fromImageElement(img: HTMLImageElement): Promise<ArtistAPhoto> {\n    const imageData = getImageData(img);\n    const state = new ImageState(img, imageData);\n    return new ArtistAPhoto(state);\n  }\n\n  // ==================== Transformation Operations ====================\n\n  crop(options: CropOptions): this {\n    validateCropParams(options, this.state.width, this.state.height);\n    const operation = new CropOperation(options);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  resize(width: number, height: number, options?: ResizeOptions): this {\n    validateDimensions(width, height);\n    const operation = new ResizeOperation(width, height, options);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  addText(options: TextOptions): this {\n    const operation = new TextOperation(options);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  addShape(options: ShapeOptions): this {\n    const operation = new ShapeOperation(options);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  // ==================== Filter Operations ====================\n\n  filter(type: FilterType, intensity: number = 1.0): this {\n    let operation: Operation;\n\n    switch (type) {\n      case 'grayscale':\n        operation = new GrayscaleFilter(intensity);\n        break;\n      case 'sepia':\n        operation = new SepiaFilter(intensity);\n        break;\n      case 'blur':\n        operation = new BlurFilter(intensity);\n        break;\n      case 'sharpen':\n        operation = new SharpenFilter(intensity);\n        break;\n      case 'vintage':\n        operation = new VintageFilter(intensity);\n        break;\n      case 'invert':\n        operation = new InvertFilter(intensity);\n        break;\n      case 'vignette':\n        operation = new VignetteFilter(intensity);\n        break;\n      case 'posterize':\n        operation = new PosterizeFilter(intensity);\n        break;\n      case 'pixelate':\n        operation = new PixelateFilter(intensity);\n        break;\n      case 'edgeDetection':\n        operation = new EdgeDetectionFilter(intensity);\n        break;\n    }\n\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  // ==================== Adjustment Operations ====================\n\n  brightness(value: number): this {\n    const operation = new BrightnessAdjustment(value);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  contrast(value: number): this {\n    const operation = new ContrastAdjustment(value);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  saturation(value: number): this {\n    const operation = new SaturationAdjustment(value);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  exposure(value: number): this {\n    const operation = new ExposureAdjustment(value);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  temperature(value: number): this {\n    const operation = new TemperatureAdjustment(value);\n    this.operationQueue.enqueue(operation);\n    return this;\n  }\n\n  // ==================== Undo/Redo Operations ====================\n\n  undo(): this {\n    this.operationQueue.undo();\n    return this;\n  }\n\n  redo(): this {\n    this.operationQueue.redo();\n    return this;\n  }\n\n  canUndo(): boolean {\n    return this.operationQueue.canUndo();\n  }\n\n  canRedo(): boolean {\n    return this.operationQueue.canRedo();\n  }\n\n  getHistory(): ReadonlyArray<Operation> {\n    return this.operationQueue.getAllOperations();\n  }\n\n  // ==================== State Management ====================\n\n  reset(): this {\n    this.operationQueue.reset();\n    return this;\n  }\n\n  getOriginal(): ImageData {\n    return this.state.originalImageData;\n  }\n\n  async preview(): Promise<HTMLCanvasElement> {\n    const operations = this.operationQueue.getActiveOperations();\n    return await this.processor.execute(this.state, operations);\n  }\n\n  // ==================== Export Operations ====================\n\n  async toCanvas(): Promise<HTMLCanvasElement> {\n    return await this.preview();\n  }\n\n  async toBlob(format?: ExportFormat, quality?: number): Promise<Blob> {\n    const canvas = await this.toCanvas();\n    return await canvasToBlob(canvas, format, quality);\n  }\n\n  async toDataURL(format?: ExportFormat, quality?: number): Promise<string> {\n    const canvas = await this.toCanvas();\n    return canvasToDataURL(canvas, format, quality);\n  }\n\n  async download(filename: string, format?: ExportFormat, quality?: number): Promise<void> {\n    const blob = await this.toBlob(format, quality);\n    downloadBlob(blob, filename);\n  }\n}\n","// Main SDK class\nexport { ArtistAPhoto } from './core/ArtistAPhoto';\n\n// Export all types\nexport type {\n  FilterType,\n  ExportFormat,\n  CropOptions,\n  ResizeOptions,\n  ImageMetadata,\n  ExportOptions,\n  AdjustmentType,\n  AdjustmentParams,\n  FilterParams,\n  OperationType,\n  TextOptions,\n  TextParams,\n  ShapeType,\n  ShapeOptions,\n  ShapeParams,\n} from './types';\n\n// Export errors\nexport {\n  ArtistAPhotoError,\n  InvalidDimensionsError,\n  InvalidCropError,\n  ImageLoadError,\n  ExportError,\n  CanvasContextError,\n} from './errors/ArtistAPhotoError';\n\n// Export worker pool for advanced usage\nexport { WorkerPool } from './workers/workerPool';\nexport type { WorkerTask, WorkerResponse } from './workers/workerPool';\n\n// Convenience factory function\nexport async function createEditor(\n  source: string | File | HTMLImageElement | HTMLCanvasElement\n): Promise<import('./core/ArtistAPhoto').ArtistAPhoto> {\n  const { ArtistAPhoto } = await import('./core/ArtistAPhoto');\n\n  if (typeof source === 'string') {\n    return ArtistAPhoto.fromUrl(source);\n  } else if (source instanceof File) {\n    return ArtistAPhoto.fromFile(source);\n  } else if (source instanceof HTMLImageElement) {\n    return ArtistAPhoto.fromImageElement(source);\n  } else if (source instanceof HTMLCanvasElement) {\n    return ArtistAPhoto.fromCanvas(source);\n  }\n\n  throw new Error('Unsupported source type');\n}\n","export interface WorkerTask {\n  type: string;\n  imageData: ImageData;\n  params?: any;\n}\n\nexport interface WorkerResponse {\n  result: ImageData;\n  error?: string;\n}\n\nexport class WorkerPool {\n  private workers: Worker[] = [];\n  private availableWorkers: Worker[] = [];\n  private maxWorkers: number;\n  private workerUrl: string | null = null;\n\n  constructor(maxWorkers?: number) {\n    this.maxWorkers = maxWorkers || navigator.hardwareConcurrency || 4;\n  }\n\n  private createWorker(): Worker {\n    if (!this.workerUrl) {\n      // Create worker from blob if worker file is not available\n      const workerCode = `\n        // Inline worker code would go here\n        // For now, this is a placeholder\n        self.onmessage = function(e) {\n          self.postMessage({ result: e.data.imageData });\n        };\n      `;\n      const blob = new Blob([workerCode], { type: 'application/javascript' });\n      this.workerUrl = URL.createObjectURL(blob);\n    }\n\n    const worker = new Worker(this.workerUrl);\n    this.workers.push(worker);\n    return worker;\n  }\n\n  private async getAvailableWorker(): Promise<Worker> {\n    if (this.availableWorkers.length > 0) {\n      return this.availableWorkers.pop()!;\n    }\n\n    if (this.workers.length < this.maxWorkers) {\n      return this.createWorker();\n    }\n\n    // Wait for a worker to become available\n    return new Promise((resolve) => {\n      const checkInterval = setInterval(() => {\n        if (this.availableWorkers.length > 0) {\n          clearInterval(checkInterval);\n          resolve(this.availableWorkers.pop()!);\n        }\n      }, 10);\n    });\n  }\n\n  private releaseWorker(worker: Worker): void {\n    this.availableWorkers.push(worker);\n  }\n\n  async execute<T = WorkerResponse>(task: WorkerTask): Promise<T> {\n    const worker = await this.getAvailableWorker();\n\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        this.releaseWorker(worker);\n        reject(new Error('Worker timeout'));\n      }, 30000); // 30 second timeout\n\n      worker.onmessage = (e: MessageEvent<T>) => {\n        clearTimeout(timeout);\n        this.releaseWorker(worker);\n        resolve(e.data);\n      };\n\n      worker.onerror = (error) => {\n        clearTimeout(timeout);\n        this.releaseWorker(worker);\n        reject(error);\n      };\n\n      worker.postMessage(task);\n    });\n  }\n\n  terminate(): void {\n    this.workers.forEach((worker) => worker.terminate());\n    this.workers = [];\n    this.availableWorkers = [];\n\n    if (this.workerUrl) {\n      URL.revokeObjectURL(this.workerUrl);\n      this.workerUrl = null;\n    }\n  }\n}\n"]}