/* ArtistAPhoto - Browser Image Editor SDK */
var it=Object.defineProperty;var l=(n,t)=>()=>(n&&(t=n(n=0)),t);var ot=(n,t)=>{for(var e in t)it(n,e,{get:t[e],enumerable:true});};var M,Le=l(()=>{M=class n{constructor(t,e){this.originalImage=t,this.originalImageData=e,this.width=e.width,this.height=e.height,this.metadata={createdAt:Date.now(),format:"unknown",width:e.width,height:e.height};}clone(){return new n(this.originalImage,this.originalImageData)}};});var K,Ie=l(()=>{K=class{constructor(){this.operations=[];this.currentIndex=-1;}enqueue(t){this.operations=this.operations.slice(0,this.currentIndex+1),this.operations.push(t),this.currentIndex++;}undo(){this.canUndo()&&this.currentIndex--;}redo(){this.canRedo()&&this.currentIndex++;}getActiveOperations(){return this.operations.slice(0,this.currentIndex+1)}getAllOperations(){return this.operations}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.operations.length-1}clear(){this.operations=[],this.currentIndex=-1;}reset(){this.currentIndex=-1;}};});var D,F,R,H,B,_,N=l(()=>{D=class n extends Error{constructor(t){super(t),this.name="ArtistAPhotoError",Object.setPrototypeOf(this,n.prototype);}},F=class n extends D{constructor(t="Invalid dimensions"){super(t),this.name="InvalidDimensionsError",Object.setPrototypeOf(this,n.prototype);}},R=class n extends D{constructor(t="Invalid crop parameters"){super(t),this.name="InvalidCropError",Object.setPrototypeOf(this,n.prototype);}},H=class n extends D{constructor(t="Failed to load image"){super(t),this.name="ImageLoadError",Object.setPrototypeOf(this,n.prototype);}},B=class n extends D{constructor(t="Failed to export image"){super(t),this.name="ExportError",Object.setPrototypeOf(this,n.prototype);}},_=class n extends D{constructor(t="Failed to get canvas context"){super(t),this.name="CanvasContextError",Object.setPrototypeOf(this,n.prototype);}};});function S(n,t){let e=document.createElement("canvas");return e.width=n,e.height=t,e}function W(n){let t=n.getContext("2d",{willReadFrequently:true});if(!t)throw new _("Failed to get 2D context");return t}function Ee(n,t="image/png",e){return new Promise((r,a)=>{n.toBlob(s=>{s?r(s):a(new B("Failed to create blob from canvas"));},t,e);})}function Pe(n,t="image/png",e){return n.toDataURL(t,e)}function ke(n,t){let e=URL.createObjectURL(n),r=document.createElement("a");r.href=e,r.download=t,r.click(),URL.revokeObjectURL(e);}function ge(n){let t=n.getContext("2d");if(!t)return;let e="ArtistAPhoto - UNLICENSED",r=Math.max(16,Math.floor(n.width*.03));t.save(),t.font=`bold ${r}px Arial, sans-serif`,t.fillStyle="rgba(128, 128, 128, 0.3)",t.textAlign="center",t.textBaseline="middle";let s=t.measureText(e).width*1.5,i=Math.sqrt(n.width**2+n.height**2);t.translate(n.width/2,n.height/2),t.rotate(-Math.PI/4);for(let o=-i;o<i;o+=s*.6)for(let m=-i;m<i;m+=s)t.fillText(e,m,o);t.restore();}var V=l(()=>{N();});var z,De=l(()=>{V();z=class{constructor(){this.canvas=S(1,1),this.ctx=W(this.canvas);}async execute(t,e){this.canvas.width=t.width,this.canvas.height=t.height,this.ctx.drawImage(t.originalImage,0,0);for(let r of e)await r.apply(this.canvas,this.ctx);return this.canvas}getCanvas(){return this.canvas}getContext(){return this.ctx}};});var ve,be,mt,Oe,O,I,q,k,x,b,Ae=l(()=>{ve="artistaphoto_license_cache",be="https://srsigor.gumroad.com",mt="https://api.gumroad.com/v2/licenses/verify",Oe=["R4Nv9B5P5-9sdVR3E3ytdg==","3i7epkgA3v0HK0r_UghsZg=="],O=null,I=null,q=false,k={productIds:Oe,storeUrl:be,cacheDuration:864e5,enableCache:true},x=class n{static configure(t){k={...k,...t};}static async setLicenseKey(t){if(!t||typeof t!="string")throw new b("License key is required","INVALID_KEY");if(O=t.trim(),k.enableCache){let r=n.getFromCache();if(r&&r.licenseInfo.key===O)return I=r.licenseInfo,q=true,I}let e=await n.validateWithGumroad(O);if(!e.valid)throw q=false,I=null,n.createErrorFromResult(e);return I=n.parseLicenseInfo(O,e),q=true,k.enableCache&&n.saveToCache(I),I}static isLicenseValid(){return q&&I!==null&&I.isValid}static getLicenseInfo(){return I}static getLicenseKey(){return O}static requireValidLicense(){if(!n.isLicenseValid()){let t=k.storeUrl||be;throw new b(`License key required. Call ArtistAPhoto.setLicenseKey() first.
Purchase a license at: ${t}`,"LICENSE_REQUIRED")}}static clearLicense(){O=null,I=null,q=false,n.clearCache();}static async refreshLicense(){if(!O)throw new b("No license key set","NO_LICENSE");return n.clearCache(),n.setLicenseKey(O)}static async validateWithGumroad(t){try{let e=k.productIds||Oe;for(let r of e)try{let a=await fetch(mt,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({product_id:r,license_key:t})});if(!a.ok)continue;let s=await a.json();if(!s.success)continue;let i=s.purchase,o=!!i.subscription_id,m=!1;if(o&&i.subscription_ended_at&&(m=new Date(i.subscription_ended_at)<new Date),s.success&&!m)return {valid:!0,gumroadResponse:s};if(m)return {valid:!1,gumroadResponse:s,error:"Subscription has expired"}}catch{continue}return {valid:!1,error:"License key not found"}}catch(e){if(k.enableCache){let r=n.getFromCache();if(r&&r.licenseInfo.key===t)return {valid:true,gumroadResponse:void 0}}return {valid:false,error:`Network error: ${e instanceof Error?e.message:"Unknown error"}`}}}static parseLicenseInfo(t,e){let r=e.gumroadResponse;if(!r||!r.purchase)return {key:t,status:"active",isValid:true,expiresAt:null,activationLimit:null,activationUsage:0,usageLimit:null,usage:0};let a=r.purchase,s="active",i=null;a.subscription_id&&a.subscription_ended_at&&(new Date(a.subscription_ended_at)<new Date&&(s="expired"),i=a.subscription_ended_at),(a.refunded||a.chargebacked)&&(s="revoked");let o=e.valid===true;return {key:t,status:o?"active":s,isValid:o,expiresAt:i,activationLimit:null,activationUsage:0,usageLimit:null,usage:0,customerEmail:a.email,customerName:a.full_name,productName:a.product_name}}static createErrorFromResult(t){let e=k.storeUrl||be;return t.error?.includes("expired")?new b(`Your license has expired.
Renew at: ${e}
Need help? Contact support.`,"LICENSE_EXPIRED"):t.error?.includes("revoked")?new b(`This license has been revoked.
Contact support for assistance.`,"LICENSE_REVOKED"):t.error?.includes("disabled")?new b(`This license has been disabled.
Contact support for assistance.`,"LICENSE_DISABLED"):t.error?.includes("not found")?new b(`License key not found.
Purchase a valid license at: ${e}`,"INVALID_KEY"):new b(`Invalid license key.
Purchase a valid license at: ${e}`,"INVALID_KEY")}static getFromCache(){try{if(typeof localStorage>"u")return null;let t=localStorage.getItem(ve);if(!t)return null;let e=JSON.parse(t);return Date.now()>e.expiresAt?(n.clearCache(),null):e}catch{return null}}static saveToCache(t){try{if(typeof localStorage>"u")return;let e=k.cacheDuration||864e5,r={licenseInfo:t,validatedAt:Date.now(),expiresAt:Date.now()+e};localStorage.setItem(ve,JSON.stringify(r));}catch{}}static clearCache(){try{typeof localStorage<"u"&&localStorage.removeItem(ve);}catch{}}},b=class n extends Error{constructor(t,e){super(t),this.name="LicenseError",this.code=e;let r=Error;r.captureStackTrace&&r.captureStackTrace(this,n);}};});async function xe(n){return new Promise((t,e)=>{let r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=()=>e(new H(`Failed to load image from ${n}`)),r.src=n;})}async function Te(n){let t=URL.createObjectURL(n);try{return await xe(t)}finally{URL.revokeObjectURL(t);}}function Q(n){let t=S(n.width,n.height),e=W(t);return e.drawImage(n,0,0),e.getImageData(0,0,n.width,n.height)}var Me=l(()=>{N();V();});function Re(n,t){if(n<=0||t<=0)throw new F("Dimensions must be positive numbers");if(n>X||t>X)throw new F(`Dimensions exceed maximum size (${X}x${X})`)}function Ue(n,t,e){let{x:r,y:a,width:s,height:i}=n;if(r<0||a<0)throw new R("Crop coordinates must be non-negative");if(s<=0||i<=0)throw new R("Crop dimensions must be positive");if(r+s>t||a+i>e)throw new R("Crop area exceeds image bounds")}function E(n,t=-100,e=100){return Math.max(t,Math.min(e,n))}function Fe(n=1){return Math.max(0,Math.min(1,n))}var X,A=l(()=>{N();X=16384;});var f,w=l(()=>{f=class{validate(){return  true}};});var Y,Se=l(()=>{w();Y=class extends f{constructor(e){super();this.type="crop";this.params=e;}async apply(e,r){let{x:a,y:s,width:i,height:o}=this.params,m=r.getImageData(a,s,i,o);e.width=i,e.height=o,r.putImageData(m,0,0);}validate(){let{x:e,y:r,width:a,height:s}=this.params;return e>=0&&r>=0&&a>0&&s>0}};});var $,We=l(()=>{w();V();$=class extends f{constructor(e,r,a){super();this.type="resize";this.params={width:e,height:r,quality:a?.quality||"high",maintainAspectRatio:a?.maintainAspectRatio??true};}async apply(e,r){let{width:a,height:s,quality:i}=this.params,o=r.getImageData(0,0,e.width,e.height),m=S(e.width,e.height);W(m).putImageData(o,0,0),e.width=a,e.height=s,r.imageSmoothingEnabled=i==="high"||i==="medium",r.imageSmoothingQuality=i==="high"?"high":i==="medium"?"medium":"low",r.drawImage(m,0,0,a,s);}validate(){let{width:e,height:r}=this.params;return e>0&&r>0}};});var G,je=l(()=>{w();G=class extends f{constructor(e){super();this.type="text";this.params={text:e.text,x:e.x,y:e.y,fontSize:e.fontSize||24,fontFamily:e.fontFamily||"Arial",color:e.color||"#000000",align:e.align||"left",baseline:e.baseline||"alphabetic",maxWidth:e.maxWidth||0,bold:e.bold||false,italic:e.italic||false,rotation:e.rotation||0,stroke:e.stroke,shadow:e.shadow};}async apply(e,r){r.save(),this.params.rotation!==0&&(r.translate(this.params.x,this.params.y),r.rotate(this.params.rotation*Math.PI/180),r.translate(-this.params.x,-this.params.y));let a=this.params.italic?"italic":"normal",s=this.params.bold?"bold":"normal";r.font=`${a} ${s} ${this.params.fontSize}px ${this.params.fontFamily}`,r.textAlign=this.params.align,r.textBaseline=this.params.baseline,this.params.shadow&&(r.shadowColor=this.params.shadow.color,r.shadowBlur=this.params.shadow.blur,r.shadowOffsetX=this.params.shadow.offsetX,r.shadowOffsetY=this.params.shadow.offsetY),this.params.stroke&&(r.strokeStyle=this.params.stroke.color,r.lineWidth=this.params.stroke.width,this.params.maxWidth>0?r.strokeText(this.params.text,this.params.x,this.params.y,this.params.maxWidth):r.strokeText(this.params.text,this.params.x,this.params.y)),r.fillStyle=this.params.color,this.params.maxWidth>0?r.fillText(this.params.text,this.params.x,this.params.y,this.params.maxWidth):r.fillText(this.params.text,this.params.x,this.params.y),r.restore();}validate(){return this.params.text.length>0&&this.params.fontSize>0&&this.params.x>=0&&this.params.y>=0}};});var J,He=l(()=>{w();J=class extends f{constructor(e){super();this.type="shape";this.params={type:e.type,x:e.x,y:e.y,width:e.width,height:e.height,fill:e.fill,stroke:e.stroke,rotation:e.rotation||0};}async apply(e,r){if(r.save(),this.params.rotation!==0){let a=this.params.x+this.params.width/2,s=this.params.y+this.params.height/2;r.translate(a,s),r.rotate(this.params.rotation*Math.PI/180),r.translate(-a,-s);}this.params.type==="rectangle"?this.drawRectangle(r):this.params.type==="ellipse"&&this.drawEllipse(r),r.restore();}drawRectangle(e){this.params.fill&&(e.fillStyle=this.params.fill,e.fillRect(this.params.x,this.params.y,this.params.width,this.params.height)),this.params.stroke&&(e.strokeStyle=this.params.stroke.color,e.lineWidth=this.params.stroke.width,e.strokeRect(this.params.x,this.params.y,this.params.width,this.params.height));}drawEllipse(e){let r=this.params.x+this.params.width/2,a=this.params.y+this.params.height/2,s=this.params.width/2,i=this.params.height/2;e.beginPath(),e.ellipse(r,a,s,i,0,0,2*Math.PI),this.params.fill&&(e.fillStyle=this.params.fill,e.fill()),this.params.stroke&&(e.strokeStyle=this.params.stroke.color,e.lineWidth=this.params.stroke.width,e.stroke());}validate(){return this.params.width>0&&this.params.height>0&&this.params.x>=0&&this.params.y>=0&&(this.params.type==="rectangle"||this.params.type==="ellipse")}};});var g,C=l(()=>{w();A();g=class extends f{constructor(e=1){super();this.type="filter";this.intensity=Fe(e);}async apply(e,r){let a=r.getImageData(0,0,e.width,e.height),s=a.data;this.applyFilter(s,e.width,e.height),r.putImageData(a,0,0);}};});var Z,Be=l(()=>{C();Z=class extends g{constructor(e=1){super(e);this.params={filterType:"grayscale"};this.params={filterType:"grayscale",intensity:this.intensity};}applyFilter(e){for(let r=0;r<e.length;r+=4){let a=e[r]*.299+e[r+1]*.587+e[r+2]*.114;e[r]=e[r]*(1-this.intensity)+a*this.intensity,e[r+1]=e[r+1]*(1-this.intensity)+a*this.intensity,e[r+2]=e[r+2]*(1-this.intensity)+a*this.intensity;}}};});function p(n,t=0,e=255){return Math.max(t,Math.min(e,n))}var P=l(()=>{});var ee,_e=l(()=>{C();P();ee=class extends g{constructor(e=1){super(e);this.params={filterType:"sepia"};this.params={filterType:"sepia",intensity:this.intensity};}applyFilter(e){for(let r=0;r<e.length;r+=4){let a=e[r],s=e[r+1],i=e[r+2],o=a*.393+s*.769+i*.189,m=a*.349+s*.686+i*.168,d=a*.272+s*.534+i*.131;e[r]=p(e[r]*(1-this.intensity)+o*this.intensity),e[r+1]=p(e[r+1]*(1-this.intensity)+m*this.intensity),e[r+2]=p(e[r+2]*(1-this.intensity)+d*this.intensity);}}};});function te(n,t,e,r,a){let s=new Uint8ClampedArray(n.length),i=Math.floor(a/2);for(let o=0;o<e;o++)for(let m=0;m<t;m++){let d=0,u=0,c=0;for(let y=0;y<a;y++)for(let v=0;v<a;v++){let L=Math.min(e-1,Math.max(0,o+y-i)),U=Math.min(t-1,Math.max(0,m+v-i)),j=(L*t+U)*4,T=r[y*a+v];d+=n[j]*T,u+=n[j+1]*T,c+=n[j+2]*T;}let h=(o*t+m)*4;s[h]=Math.max(0,Math.min(255,d)),s[h+1]=Math.max(0,Math.min(255,u)),s[h+2]=Math.max(0,Math.min(255,c)),s[h+3]=n[h+3];}return s}var Ne,Ve,qe,Qe,re=l(()=>{Ne=[1/16,2/16,1/16,2/16,4/16,2/16,1/16,2/16,1/16],Ve=[0,-1,0,-1,5,-1,0,-1,0],qe=[-1,0,1,-2,0,2,-1,0,1],Qe=[-1,-2,-1,0,0,0,1,2,1];});var se,Ke=l(()=>{C();re();se=class extends g{constructor(t=1,e=1){super(t),this.params={filterType:"blur",intensity:this.intensity,radius:e};}applyFilter(t,e,r){let a=te(t,e,r,Ne,3);for(let s=0;s<t.length;s++)(s+1)%4!==0&&(t[s]=t[s]*(1-this.intensity)+a[s]*this.intensity);}};});var ae,ze=l(()=>{C();re();ae=class extends g{constructor(t=1){super(t),this.params={filterType:"sharpen",intensity:this.intensity};}applyFilter(t,e,r){let a=te(t,e,r,Ve,3);for(let s=0;s<t.length;s++)(s+1)%4!==0&&(t[s]=t[s]*(1-this.intensity)+a[s]*this.intensity);}};});var ne,Xe=l(()=>{C();P();ne=class extends g{constructor(t=1){super(t),this.params={filterType:"vintage",intensity:this.intensity};}applyFilter(t,e,r){for(let a=0;a<r;a++)for(let s=0;s<e;s++){let i=(a*e+s)*4,o=t[i],m=t[i+1],d=t[i+2],u=o*.9+30,c=m*.85+10,h=d*.7,y=(u+c+h)/3;u=u*.8+y*.2,c=c*.8+y*.2,h=h*.8+y*.2;let v=e/2,L=r/2,U=Math.sqrt(Math.pow(s-v,2)+Math.pow(a-L,2)),j=Math.sqrt(Math.pow(v,2)+Math.pow(L,2)),T=1-U/j*.5;u*=T,c*=T,h*=T,t[i]=p(t[i]*(1-this.intensity)+u*this.intensity),t[i+1]=p(t[i+1]*(1-this.intensity)+c*this.intensity),t[i+2]=p(t[i+2]*(1-this.intensity)+h*this.intensity);}}};});var ie,Ye=l(()=>{C();ie=class extends g{constructor(e=1){super(e);this.params={filterType:"invert"};this.params={filterType:"invert",intensity:this.intensity};}applyFilter(e){for(let r=0;r<e.length;r+=4)e[r]=e[r]*(1-this.intensity)+(255-e[r])*this.intensity,e[r+1]=e[r+1]*(1-this.intensity)+(255-e[r+1])*this.intensity,e[r+2]=e[r+2]*(1-this.intensity)+(255-e[r+2])*this.intensity;}};});var oe,$e=l(()=>{C();oe=class extends g{constructor(t=1,e=.5){super(t),this.params={filterType:"vignette",intensity:this.intensity,strength:Math.max(0,Math.min(1,e))};}applyFilter(t,e,r){let a=e/2,s=r/2,i=Math.sqrt(a*a+s*s),o=this.params.strength||.5;for(let m=0;m<r;m++)for(let d=0;d<e;d++){let c=1-Math.sqrt(Math.pow(d-a,2)+Math.pow(m-s,2))/i*o,h=Math.max(0,Math.min(1,c)),y=(m*e+d)*4,v=t[y],L=t[y+1],U=t[y+2];t[y]=v*(1-this.intensity)+v*h*this.intensity,t[y+1]=L*(1-this.intensity)+L*h*this.intensity,t[y+2]=U*(1-this.intensity)+U*h*this.intensity;}}};});var me,Ge=l(()=>{C();P();me=class extends g{constructor(t=1,e=4){super(t),this.params={filterType:"posterize",intensity:this.intensity,levels:Math.max(2,Math.min(16,Math.floor(e)))};}applyFilter(t){let r=255/((this.params.levels||4)-1);for(let a=0;a<t.length;a+=4){let s=t[a],i=t[a+1],o=t[a+2],m=Math.round(s/r)*r,d=Math.round(i/r)*r,u=Math.round(o/r)*r;t[a]=p(t[a]*(1-this.intensity)+m*this.intensity),t[a+1]=p(t[a+1]*(1-this.intensity)+d*this.intensity),t[a+2]=p(t[a+2]*(1-this.intensity)+u*this.intensity);}}};});var pe,Je=l(()=>{C();pe=class extends g{constructor(t=1,e=10){super(t),this.params={filterType:"pixelate",intensity:this.intensity,blockSize:Math.max(1,Math.floor(e))};}applyFilter(t,e,r){let a=this.params.blockSize||10,s=new Uint8ClampedArray(t);for(let i=0;i<r;i+=a)for(let o=0;o<e;o+=a){let m=this.getBlockAverage(s,o,i,a,e,r);this.fillBlock(t,s,o,i,a,e,r,m);}}getBlockAverage(t,e,r,a,s,i){let o=0,m=0,d=0,u=0;for(let c=r;c<Math.min(r+a,i);c++)for(let h=e;h<Math.min(e+a,s);h++){let y=(c*s+h)*4;o+=t[y],m+=t[y+1],d+=t[y+2],u++;}return [Math.round(o/u),Math.round(m/u),Math.round(d/u)]}fillBlock(t,e,r,a,s,i,o,m){let[d,u,c]=m;for(let h=a;h<Math.min(a+s,o);h++)for(let y=r;y<Math.min(r+s,i);y++){let v=(h*i+y)*4;t[v]=e[v]*(1-this.intensity)+d*this.intensity,t[v+1]=e[v+1]*(1-this.intensity)+u*this.intensity,t[v+2]=e[v+2]*(1-this.intensity)+c*this.intensity;}}};});var le,Ze=l(()=>{C();re();P();le=class extends g{constructor(t=1){super(t),this.params={filterType:"edgeDetection",intensity:this.intensity};}applyFilter(t,e,r){let a=new Uint8ClampedArray(t.length);for(let i=0;i<t.length;i+=4){let o=t[i]*.299+t[i+1]*.587+t[i+2]*.114;a[i]=a[i+1]=a[i+2]=o,a[i+3]=t[i+3];}let s=this.applySobel(a,e,r);for(let i=0;i<t.length;i+=4)t[i]=t[i]*(1-this.intensity)+s[i]*this.intensity,t[i+1]=t[i+1]*(1-this.intensity)+s[i+1]*this.intensity,t[i+2]=t[i+2]*(1-this.intensity)+s[i+2]*this.intensity;}applySobel(t,e,r){let a=new Uint8ClampedArray(t.length);for(let s=1;s<r-1;s++)for(let i=1;i<e-1;i++){let o=0,m=0;for(let c=-1;c<=1;c++)for(let h=-1;h<=1;h++){let y=((s+c)*e+(i+h))*4,v=(c+1)*3+(h+1),L=t[y];o+=L*qe[v],m+=L*Qe[v];}let d=Math.sqrt(o*o+m*m),u=(s*e+i)*4;a[u]=a[u+1]=a[u+2]=p(d),a[u+3]=t[u+3];}return a}};});var ce,et=l(()=>{w();A();P();ce=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"brightness",value:E(e)};}async apply(e,r){let a=r.getImageData(0,0,e.width,e.height),s=a.data,i=this.params.value*2.55;for(let o=0;o<s.length;o+=4)s[o]=p(s[o]+i),s[o+1]=p(s[o+1]+i),s[o+2]=p(s[o+2]+i);r.putImageData(a,0,0);}};});var he,tt=l(()=>{w();A();P();he=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"contrast",value:E(e)};}async apply(e,r){let a=r.getImageData(0,0,e.width,e.height),s=a.data,i=259*(this.params.value+255)/(255*(259-this.params.value));for(let o=0;o<s.length;o+=4)s[o]=p(i*(s[o]-128)+128),s[o+1]=p(i*(s[o+1]-128)+128),s[o+2]=p(i*(s[o+2]-128)+128);r.putImageData(a,0,0);}};});var ue,rt=l(()=>{w();A();P();ue=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"saturation",value:E(e)};}async apply(e,r){let a=r.getImageData(0,0,e.width,e.height),s=a.data,i=(this.params.value+100)/100;for(let o=0;o<s.length;o+=4){let m=s[o],d=s[o+1],u=s[o+2],c=.299*m+.587*d+.114*u;s[o]=p(c+i*(m-c)),s[o+1]=p(c+i*(d-c)),s[o+2]=p(c+i*(u-c));}r.putImageData(a,0,0);}};});var de,st=l(()=>{w();A();P();de=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"exposure",value:E(e)};}async apply(e,r){let a=r.getImageData(0,0,e.width,e.height),s=a.data,i=this.params.value/100,o=Math.pow(2,i);for(let m=0;m<s.length;m+=4)s[m]=p(s[m]*o),s[m+1]=p(s[m+1]*o),s[m+2]=p(s[m+2]*o);r.putImageData(a,0,0);}};});var ye,at=l(()=>{w();A();P();ye=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"temperature",value:E(e)};}async apply(e,r){let a=r.getImageData(0,0,e.width,e.height),s=a.data,i=this.params.value/100;for(let o=0;o<s.length;o+=4)i>0?(s[o]=p(s[o]+i*40),s[o+2]=p(s[o+2]-i*40)):(s[o]=p(s[o]+i*40),s[o+2]=p(s[o+2]-i*40));r.putImageData(a,0,0);}};});var nt={};ot(nt,{ArtistAPhoto:()=>fe,LicenseError:()=>b});var fe,we=l(()=>{Le();Ie();De();Ae();Me();V();A();Se();We();je();He();Be();_e();Ke();ze();Xe();Ye();$e();Ge();Je();Ze();et();tt();rt();st();at();fe=class n{constructor(t){this.state=t,this.operationQueue=new K,this.processor=new z;}static configure(t){x.configure(t);}static async setLicenseKey(t){return x.setLicenseKey(t)}static isLicenseValid(){return x.isLicenseValid()}static getLicenseInfo(){return x.getLicenseInfo()}static clearLicense(){x.clearLicense();}static async refreshLicense(){return x.refreshLicense()}static async fromUrl(t){let e=await xe(t),r=Q(e),a=new M(e,r);return new n(a)}static async fromFile(t){let e=await Te(t),r=Q(e),a=new M(e,r);return new n(a)}static async fromCanvas(t){let e=new Image;e.src=t.toDataURL(),await new Promise(s=>e.onload=s);let r=Q(e),a=new M(e,r);return new n(a)}static async fromImageElement(t){let e=Q(t),r=new M(t,e);return new n(r)}crop(t){Ue(t,this.state.width,this.state.height);let e=new Y(t);return this.operationQueue.enqueue(e),this}resize(t,e,r){Re(t,e);let a=new $(t,e,r);return this.operationQueue.enqueue(a),this}addText(t){let e=new G(t);return this.operationQueue.enqueue(e),this}addShape(t){let e=new J(t);return this.operationQueue.enqueue(e),this}filter(t,e=1){let r;switch(t){case "grayscale":r=new Z(e);break;case "sepia":r=new ee(e);break;case "blur":r=new se(e);break;case "sharpen":r=new ae(e);break;case "vintage":r=new ne(e);break;case "invert":r=new ie(e);break;case "vignette":r=new oe(e);break;case "posterize":r=new me(e);break;case "pixelate":r=new pe(e);break;case "edgeDetection":r=new le(e);break}return this.operationQueue.enqueue(r),this}brightness(t){let e=new ce(t);return this.operationQueue.enqueue(e),this}contrast(t){let e=new he(t);return this.operationQueue.enqueue(e),this}saturation(t){let e=new ue(t);return this.operationQueue.enqueue(e),this}exposure(t){let e=new de(t);return this.operationQueue.enqueue(e),this}temperature(t){let e=new ye(t);return this.operationQueue.enqueue(e),this}undo(){return this.operationQueue.undo(),this}redo(){return this.operationQueue.redo(),this}canUndo(){return this.operationQueue.canUndo()}canRedo(){return this.operationQueue.canRedo()}getHistory(){return this.operationQueue.getAllOperations()}reset(){return this.operationQueue.reset(),this}getOriginal(){return this.state.originalImageData}async preview(){let t=this.operationQueue.getActiveOperations();return await this.processor.execute(this.state,t)}async toCanvas(){return await this.preview()}async toBlob(t,e){let r=await this.toCanvas();return x.isLicenseValid()||ge(r),await Ee(r,t,e)}async toDataURL(t,e){let r=await this.toCanvas();return x.isLicenseValid()||ge(r),Pe(r,t,e)}async download(t,e,r){let a=await this.toBlob(e,r);ke(a,t);}};});we();N();var Ce=class{constructor(t){this.workers=[];this.availableWorkers=[];this.workerUrl=null;this.maxWorkers=t||navigator.hardwareConcurrency||4;}createWorker(){if(!this.workerUrl){let e=`
        // Inline worker code would go here
        // For now, this is a placeholder
        self.onmessage = function(e) {
          self.postMessage({ result: e.data.imageData });
        };
      `,r=new Blob([e],{type:"application/javascript"});this.workerUrl=URL.createObjectURL(r);}let t=new Worker(this.workerUrl);return this.workers.push(t),t}async getAvailableWorker(){return this.availableWorkers.length>0?this.availableWorkers.pop():this.workers.length<this.maxWorkers?this.createWorker():new Promise(t=>{let e=setInterval(()=>{this.availableWorkers.length>0&&(clearInterval(e),t(this.availableWorkers.pop()));},10);})}releaseWorker(t){this.availableWorkers.push(t);}async execute(t){let e=await this.getAvailableWorker();return new Promise((r,a)=>{let s=setTimeout(()=>{this.releaseWorker(e),a(new Error("Worker timeout"));},3e4);e.onmessage=i=>{clearTimeout(s),this.releaseWorker(e),r(i.data);},e.onerror=i=>{clearTimeout(s),this.releaseWorker(e),a(i);},e.postMessage(t);})}terminate(){this.workers.forEach(t=>t.terminate()),this.workers=[],this.availableWorkers=[],this.workerUrl&&(URL.revokeObjectURL(this.workerUrl),this.workerUrl=null);}};async function as(n){let{ArtistAPhoto:t}=await Promise.resolve().then(()=>(we(),nt));if(typeof n=="string")return t.fromUrl(n);if(n instanceof File)return t.fromFile(n);if(n instanceof HTMLImageElement)return t.fromImageElement(n);if(n instanceof HTMLCanvasElement)return t.fromCanvas(n);throw new Error("Unsupported source type")}export{fe as ArtistAPhoto,D as ArtistAPhotoError,_ as CanvasContextError,B as ExportError,H as ImageLoadError,R as InvalidCropError,F as InvalidDimensionsError,b as LicenseError,Ce as WorkerPool,as as createEditor};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map