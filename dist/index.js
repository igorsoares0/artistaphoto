'use strict';/* ArtistAPhoto - Browser Image Editor SDK */
var tt=Object.defineProperty;var l=(a,t)=>()=>(a&&(t=a(a=0)),t);var rt=(a,t)=>{for(var e in t)tt(a,e,{get:t[e],enumerable:true});};var O,be=l(()=>{O=class a{constructor(t,e){this.originalImage=t,this.originalImageData=e,this.width=e.width,this.height=e.height,this.metadata={createdAt:Date.now(),format:"unknown",width:e.width,height:e.height};}clone(){return new a(this.originalImage,this.originalImageData)}};});var q,xe=l(()=>{q=class{constructor(){this.operations=[];this.currentIndex=-1;}enqueue(t){this.operations=this.operations.slice(0,this.currentIndex+1),this.operations.push(t),this.currentIndex++;}undo(){this.canUndo()&&this.currentIndex--;}redo(){this.canRedo()&&this.currentIndex++;}getActiveOperations(){return this.operations.slice(0,this.currentIndex+1)}getAllOperations(){return this.operations}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.operations.length-1}clear(){this.operations=[],this.currentIndex=-1;}reset(){this.currentIndex=-1;}};});exports.ArtistAPhotoError=void 0;exports.InvalidDimensionsError=void 0;exports.InvalidCropError=void 0;exports.ImageLoadError=void 0;exports.ExportError=void 0;exports.CanvasContextError=void 0;var V=l(()=>{exports.ArtistAPhotoError=class a extends Error{constructor(t){super(t),this.name="ArtistAPhotoError",Object.setPrototypeOf(this,a.prototype);}},exports.InvalidDimensionsError=class a extends exports.ArtistAPhotoError{constructor(t="Invalid dimensions"){super(t),this.name="InvalidDimensionsError",Object.setPrototypeOf(this,a.prototype);}},exports.InvalidCropError=class a extends exports.ArtistAPhotoError{constructor(t="Invalid crop parameters"){super(t),this.name="InvalidCropError",Object.setPrototypeOf(this,a.prototype);}},exports.ImageLoadError=class a extends exports.ArtistAPhotoError{constructor(t="Failed to load image"){super(t),this.name="ImageLoadError",Object.setPrototypeOf(this,a.prototype);}},exports.ExportError=class a extends exports.ArtistAPhotoError{constructor(t="Failed to export image"){super(t),this.name="ExportError",Object.setPrototypeOf(this,a.prototype);}},exports.CanvasContextError=class a extends exports.ArtistAPhotoError{constructor(t="Failed to get canvas context"){super(t),this.name="CanvasContextError",Object.setPrototypeOf(this,a.prototype);}};});function F(a,t){let e=document.createElement("canvas");return e.width=a,e.height=t,e}function U(a){let t=a.getContext("2d",{willReadFrequently:true});if(!t)throw new exports.CanvasContextError("Failed to get 2D context");return t}function we(a,t="image/png",e){return new Promise((r,s)=>{a.toBlob(i=>{i?r(i):s(new exports.ExportError("Failed to create blob from canvas"));},t,e);})}function Ce(a,t="image/png",e){return a.toDataURL(t,e)}function Ie(a,t){let e=URL.createObjectURL(a),r=document.createElement("a");r.href=e,r.download=t,r.click(),URL.revokeObjectURL(e);}var B=l(()=>{V();});var _,Le=l(()=>{B();_=class{constructor(){this.canvas=F(1,1),this.ctx=U(this.canvas);}async execute(t,e){this.canvas.width=t.width,this.canvas.height=t.height,this.ctx.drawImage(t.originalImage,0,0);for(let r of e)await r.apply(this.canvas,this.ctx);return this.canvas}getCanvas(){return this.canvas}getContext(){return this.ctx}};});var de,ye,it,b,x;exports.LicenseError=void 0;var Ee=l(()=>{de="artistaphoto_license_cache",ye="https://artistaphoto.lemonsqueezy.com",it="https://api.lemonsqueezy.com/v1/licenses",b=class b{static enableDevMode(){this.devMode=true,this.isValidated=true,this.licenseInfo={key:"DEV-MODE",status:"active",isValid:true,expiresAt:null,activationLimit:999,activationUsage:1,customerEmail:"dev@localhost",customerName:"Development Mode",productName:"ArtistAPhoto SDK (Dev)"},console.log("\u{1F527} ArtistAPhoto: Development mode enabled - license validation bypassed");}static isDevMode(){return this.devMode}static configure(t){this.config={...this.config,...t};}static async setLicenseKey(t){if(!t||typeof t!="string")throw new exports.LicenseError("License key is required","INVALID_KEY");if(this.licenseKey=t.trim(),this.config.enableCache){let r=this.getFromCache();if(r&&r.licenseInfo.key===this.licenseKey)return this.licenseInfo=r.licenseInfo,this.isValidated=true,this.licenseInfo}let e=await this.validateWithLemonSqueezy(this.licenseKey);if(!e.valid)throw this.isValidated=false,this.licenseInfo=null,this.createErrorFromResult(e);return this.licenseInfo=this.parseLicenseInfo(this.licenseKey,e),this.isValidated=true,this.config.enableCache&&this.saveToCache(this.licenseInfo),this.licenseInfo}static isLicenseValid(){if(b.devMode)return  true;let t=b.isValidated&&b.licenseInfo!==null&&b.licenseInfo.isValid;return console.log("\u{1F50D} License check:",{devMode:b.devMode,isValidated:b.isValidated,licenseInfo:b.licenseInfo,result:t}),t}static getLicenseInfo(){return this.licenseInfo}static getLicenseKey(){return this.licenseKey}static requireValidLicense(){if(!b.devMode&&!b.isLicenseValid()){let t=b.config.storeUrl||ye;throw new exports.LicenseError(`License key required. Call ArtistAPhoto.setLicenseKey() first.
Purchase a license at: ${t}`,"LICENSE_REQUIRED")}}static clearLicense(){this.licenseKey=null,this.licenseInfo=null,this.isValidated=false,this.clearCache();}static async refreshLicense(){if(!this.licenseKey)throw new exports.LicenseError("No license key set","NO_LICENSE");return this.clearCache(),this.setLicenseKey(this.licenseKey)}static async validateWithLemonSqueezy(t){try{let e=this.getInstanceName(),r=await fetch(`${it}/validate`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({license_key:t,instance_name:e})});return r.ok?await r.json():{valid:!1,error:`HTTP error: ${r.status}`}}catch(e){if(this.config.enableCache){let r=this.getFromCache();if(r&&r.licenseInfo.key===t)return {valid:true,license_key:{id:0,status:r.licenseInfo.status,key:r.licenseInfo.key,activation_limit:r.licenseInfo.activationLimit,activation_usage:r.licenseInfo.activationUsage,created_at:"",expires_at:r.licenseInfo.expiresAt}}}return {valid:false,error:`Network error: ${e instanceof Error?e.message:"Unknown error"}`}}}static getInstanceName(){return typeof window<"u"&&window.location?window.location.hostname:"nodejs-server"}static parseLicenseInfo(t,e){let r=e.license_key,s=e.meta,i="invalid";if(r)switch(r.status){case "active":i="active";break;case "expired":i="expired";break;case "disabled":i="disabled";break;default:i="invalid";}return {key:t,status:i,isValid:e.valid&&i==="active",expiresAt:r?.expires_at||null,activationLimit:r?.activation_limit||0,activationUsage:r?.activation_usage||0,customerEmail:s?.customer_email,customerName:s?.customer_name,productName:s?.product_name}}static createErrorFromResult(t){let e=this.config.storeUrl||ye;if(t.error?.includes("expired"))return new exports.LicenseError(`Your license has expired.
Renew at: ${e}
Need help? Contact support.`,"LICENSE_EXPIRED");if(t.error?.includes("Activation limit")){let r=t.license_key?.activation_limit||"N/A";return new exports.LicenseError(`Activation limit reached (${r} sites maximum).
Manage activations at: https://app.lemonsqueezy.com
Need more? Upgrade at ${e}`,"ACTIVATION_LIMIT")}return t.error?.includes("disabled")?new exports.LicenseError(`This license has been disabled.
Contact support for assistance.`,"LICENSE_DISABLED"):new exports.LicenseError(`Invalid license key.
Purchase a valid license at: ${e}`,"INVALID_KEY")}static getFromCache(){try{if(typeof localStorage>"u")return null;let t=localStorage.getItem(de);if(!t)return null;let e=JSON.parse(t);return Date.now()>e.expiresAt?(this.clearCache(),null):e}catch{return null}}static saveToCache(t){try{if(typeof localStorage>"u")return;let e=this.config.cacheDuration||864e5,r={licenseInfo:t,validatedAt:Date.now(),expiresAt:Date.now()+e};localStorage.setItem(de,JSON.stringify(r));}catch{}}static clearCache(){try{typeof localStorage<"u"&&localStorage.removeItem(de);}catch{}}};b.licenseKey=null,b.licenseInfo=null,b.isValidated=false,b.devMode=false,b.config={storeUrl:ye,cacheDuration:864e5,enableCache:true};x=b,exports.LicenseError=class a extends Error{constructor(t,e){super(t),this.name="LicenseError",this.code=e;let r=Error;r.captureStackTrace&&r.captureStackTrace(this,a);}};});async function fe(a){return new Promise((t,e)=>{let r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=()=>e(new exports.ImageLoadError(`Failed to load image from ${a}`)),r.src=a;})}async function ke(a){let t=URL.createObjectURL(a);try{return await fe(t)}finally{URL.revokeObjectURL(t);}}function N(a){let t=F(a.width,a.height),e=U(t);return e.drawImage(a,0,0),e.getImageData(0,0,a.width,a.height)}var Pe=l(()=>{V();B();});function Ae(a,t){if(a<=0||t<=0)throw new exports.InvalidDimensionsError("Dimensions must be positive numbers");if(a>K||t>K)throw new exports.InvalidDimensionsError(`Dimensions exceed maximum size (${K}x${K})`)}function Me(a,t,e){let{x:r,y:s,width:i,height:n}=a;if(r<0||s<0)throw new exports.InvalidCropError("Crop coordinates must be non-negative");if(i<=0||n<=0)throw new exports.InvalidCropError("Crop dimensions must be positive");if(r+i>t||s+n>e)throw new exports.InvalidCropError("Crop area exceeds image bounds")}function E(a,t=-100,e=100){return Math.max(t,Math.min(e,a))}function Oe(a=1){return Math.max(0,Math.min(1,a))}var K,A=l(()=>{V();K=16384;});var f,C=l(()=>{f=class{validate(){return  true}};});var Q,De=l(()=>{C();Q=class extends f{constructor(e){super();this.type="crop";this.params=e;}async apply(e,r){let{x:s,y:i,width:n,height:o}=this.params,m=r.getImageData(s,i,n,o);e.width=n,e.height=o,r.putImageData(m,0,0);}validate(){let{x:e,y:r,width:s,height:i}=this.params;return e>=0&&r>=0&&s>0&&i>0}};});var z,Te=l(()=>{C();B();z=class extends f{constructor(e,r,s){super();this.type="resize";this.params={width:e,height:r,quality:s?.quality||"high",maintainAspectRatio:s?.maintainAspectRatio??true};}async apply(e,r){let{width:s,height:i,quality:n}=this.params,o=r.getImageData(0,0,e.width,e.height),m=F(e.width,e.height);U(m).putImageData(o,0,0),e.width=s,e.height=i,r.imageSmoothingEnabled=n==="high"||n==="medium",r.imageSmoothingQuality=n==="high"?"high":n==="medium"?"medium":"low",r.drawImage(m,0,0,s,i);}validate(){let{width:e,height:r}=this.params;return e>0&&r>0}};});var $,Re=l(()=>{C();$=class extends f{constructor(e){super();this.type="text";this.params={text:e.text,x:e.x,y:e.y,fontSize:e.fontSize||24,fontFamily:e.fontFamily||"Arial",color:e.color||"#000000",align:e.align||"left",baseline:e.baseline||"alphabetic",maxWidth:e.maxWidth||0,bold:e.bold||false,italic:e.italic||false,rotation:e.rotation||0,stroke:e.stroke,shadow:e.shadow};}async apply(e,r){r.save(),this.params.rotation!==0&&(r.translate(this.params.x,this.params.y),r.rotate(this.params.rotation*Math.PI/180),r.translate(-this.params.x,-this.params.y));let s=this.params.italic?"italic":"normal",i=this.params.bold?"bold":"normal";r.font=`${s} ${i} ${this.params.fontSize}px ${this.params.fontFamily}`,r.textAlign=this.params.align,r.textBaseline=this.params.baseline,this.params.shadow&&(r.shadowColor=this.params.shadow.color,r.shadowBlur=this.params.shadow.blur,r.shadowOffsetX=this.params.shadow.offsetX,r.shadowOffsetY=this.params.shadow.offsetY),this.params.stroke&&(r.strokeStyle=this.params.stroke.color,r.lineWidth=this.params.stroke.width,this.params.maxWidth>0?r.strokeText(this.params.text,this.params.x,this.params.y,this.params.maxWidth):r.strokeText(this.params.text,this.params.x,this.params.y)),r.fillStyle=this.params.color,this.params.maxWidth>0?r.fillText(this.params.text,this.params.x,this.params.y,this.params.maxWidth):r.fillText(this.params.text,this.params.x,this.params.y),r.restore();}validate(){return this.params.text.length>0&&this.params.fontSize>0&&this.params.x>=0&&this.params.y>=0}};});var X,Fe=l(()=>{C();X=class extends f{constructor(e){super();this.type="shape";this.params={type:e.type,x:e.x,y:e.y,width:e.width,height:e.height,fill:e.fill,stroke:e.stroke,rotation:e.rotation||0};}async apply(e,r){if(r.save(),this.params.rotation!==0){let s=this.params.x+this.params.width/2,i=this.params.y+this.params.height/2;r.translate(s,i),r.rotate(this.params.rotation*Math.PI/180),r.translate(-s,-i);}this.params.type==="rectangle"?this.drawRectangle(r):this.params.type==="ellipse"&&this.drawEllipse(r),r.restore();}drawRectangle(e){this.params.fill&&(e.fillStyle=this.params.fill,e.fillRect(this.params.x,this.params.y,this.params.width,this.params.height)),this.params.stroke&&(e.strokeStyle=this.params.stroke.color,e.lineWidth=this.params.stroke.width,e.strokeRect(this.params.x,this.params.y,this.params.width,this.params.height));}drawEllipse(e){let r=this.params.x+this.params.width/2,s=this.params.y+this.params.height/2,i=this.params.width/2,n=this.params.height/2;e.beginPath(),e.ellipse(r,s,i,n,0,0,2*Math.PI),this.params.fill&&(e.fillStyle=this.params.fill,e.fill()),this.params.stroke&&(e.strokeStyle=this.params.stroke.color,e.lineWidth=this.params.stroke.width,e.stroke());}validate(){return this.params.width>0&&this.params.height>0&&this.params.x>=0&&this.params.y>=0&&(this.params.type==="rectangle"||this.params.type==="ellipse")}};});var g,I=l(()=>{C();A();g=class extends f{constructor(e=1){super();this.type="filter";this.intensity=Oe(e);}async apply(e,r){let s=r.getImageData(0,0,e.width,e.height),i=s.data;this.applyFilter(i,e.width,e.height),r.putImageData(s,0,0);}};});var Y,Ue=l(()=>{I();Y=class extends g{constructor(e=1){super(e);this.params={filterType:"grayscale"};this.params={filterType:"grayscale",intensity:this.intensity};}applyFilter(e){for(let r=0;r<e.length;r+=4){let s=e[r]*.299+e[r+1]*.587+e[r+2]*.114;e[r]=e[r]*(1-this.intensity)+s*this.intensity,e[r+1]=e[r+1]*(1-this.intensity)+s*this.intensity,e[r+2]=e[r+2]*(1-this.intensity)+s*this.intensity;}}};});function p(a,t=0,e=255){return Math.max(t,Math.min(e,a))}var k=l(()=>{});var G,Se=l(()=>{I();k();G=class extends g{constructor(e=1){super(e);this.params={filterType:"sepia"};this.params={filterType:"sepia",intensity:this.intensity};}applyFilter(e){for(let r=0;r<e.length;r+=4){let s=e[r],i=e[r+1],n=e[r+2],o=s*.393+i*.769+n*.189,m=s*.349+i*.686+n*.168,y=s*.272+i*.534+n*.131;e[r]=p(e[r]*(1-this.intensity)+o*this.intensity),e[r+1]=p(e[r+1]*(1-this.intensity)+m*this.intensity),e[r+2]=p(e[r+2]*(1-this.intensity)+y*this.intensity);}}};});function J(a,t,e,r,s){let i=new Uint8ClampedArray(a.length),n=Math.floor(s/2);for(let o=0;o<e;o++)for(let m=0;m<t;m++){let y=0,u=0,c=0;for(let d=0;d<s;d++)for(let v=0;v<s;v++){let L=Math.min(e-1,Math.max(0,o+d-n)),T=Math.min(t-1,Math.max(0,m+v-n)),S=(L*t+T)*4,M=r[d*s+v];y+=a[S]*M,u+=a[S+1]*M,c+=a[S+2]*M;}let h=(o*t+m)*4;i[h]=Math.max(0,Math.min(255,y)),i[h+1]=Math.max(0,Math.min(255,u)),i[h+2]=Math.max(0,Math.min(255,c)),i[h+3]=a[h+3];}return i}var je,We,He,Ve,Z=l(()=>{je=[1/16,2/16,1/16,2/16,4/16,2/16,1/16,2/16,1/16],We=[0,-1,0,-1,5,-1,0,-1,0],He=[-1,0,1,-2,0,2,-1,0,1],Ve=[-1,-2,-1,0,0,0,1,2,1];});var ee,Be=l(()=>{I();Z();ee=class extends g{constructor(t=1,e=1){super(t),this.params={filterType:"blur",intensity:this.intensity,radius:e};}applyFilter(t,e,r){let s=J(t,e,r,je,3);for(let i=0;i<t.length;i++)(i+1)%4!==0&&(t[i]=t[i]*(1-this.intensity)+s[i]*this.intensity);}};});var te,Ne=l(()=>{I();Z();te=class extends g{constructor(t=1){super(t),this.params={filterType:"sharpen",intensity:this.intensity};}applyFilter(t,e,r){let s=J(t,e,r,We,3);for(let i=0;i<t.length;i++)(i+1)%4!==0&&(t[i]=t[i]*(1-this.intensity)+s[i]*this.intensity);}};});var re,qe=l(()=>{I();k();re=class extends g{constructor(t=1){super(t),this.params={filterType:"vintage",intensity:this.intensity};}applyFilter(t,e,r){for(let s=0;s<r;s++)for(let i=0;i<e;i++){let n=(s*e+i)*4,o=t[n],m=t[n+1],y=t[n+2],u=o*.9+30,c=m*.85+10,h=y*.7,d=(u+c+h)/3;u=u*.8+d*.2,c=c*.8+d*.2,h=h*.8+d*.2;let v=e/2,L=r/2,T=Math.sqrt(Math.pow(i-v,2)+Math.pow(s-L,2)),S=Math.sqrt(Math.pow(v,2)+Math.pow(L,2)),M=1-T/S*.5;u*=M,c*=M,h*=M,t[n]=p(t[n]*(1-this.intensity)+u*this.intensity),t[n+1]=p(t[n+1]*(1-this.intensity)+c*this.intensity),t[n+2]=p(t[n+2]*(1-this.intensity)+h*this.intensity);}}};});var ie,_e=l(()=>{I();ie=class extends g{constructor(e=1){super(e);this.params={filterType:"invert"};this.params={filterType:"invert",intensity:this.intensity};}applyFilter(e){for(let r=0;r<e.length;r+=4)e[r]=e[r]*(1-this.intensity)+(255-e[r])*this.intensity,e[r+1]=e[r+1]*(1-this.intensity)+(255-e[r+1])*this.intensity,e[r+2]=e[r+2]*(1-this.intensity)+(255-e[r+2])*this.intensity;}};});var se,Ke=l(()=>{I();se=class extends g{constructor(t=1,e=.5){super(t),this.params={filterType:"vignette",intensity:this.intensity,strength:Math.max(0,Math.min(1,e))};}applyFilter(t,e,r){let s=e/2,i=r/2,n=Math.sqrt(s*s+i*i),o=this.params.strength||.5;for(let m=0;m<r;m++)for(let y=0;y<e;y++){let c=1-Math.sqrt(Math.pow(y-s,2)+Math.pow(m-i,2))/n*o,h=Math.max(0,Math.min(1,c)),d=(m*e+y)*4,v=t[d],L=t[d+1],T=t[d+2];t[d]=v*(1-this.intensity)+v*h*this.intensity,t[d+1]=L*(1-this.intensity)+L*h*this.intensity,t[d+2]=T*(1-this.intensity)+T*h*this.intensity;}}};});var ae,Qe=l(()=>{I();k();ae=class extends g{constructor(t=1,e=4){super(t),this.params={filterType:"posterize",intensity:this.intensity,levels:Math.max(2,Math.min(16,Math.floor(e)))};}applyFilter(t){let r=255/((this.params.levels||4)-1);for(let s=0;s<t.length;s+=4){let i=t[s],n=t[s+1],o=t[s+2],m=Math.round(i/r)*r,y=Math.round(n/r)*r,u=Math.round(o/r)*r;t[s]=p(t[s]*(1-this.intensity)+m*this.intensity),t[s+1]=p(t[s+1]*(1-this.intensity)+y*this.intensity),t[s+2]=p(t[s+2]*(1-this.intensity)+u*this.intensity);}}};});var ne,ze=l(()=>{I();ne=class extends g{constructor(t=1,e=10){super(t),this.params={filterType:"pixelate",intensity:this.intensity,blockSize:Math.max(1,Math.floor(e))};}applyFilter(t,e,r){let s=this.params.blockSize||10,i=new Uint8ClampedArray(t);for(let n=0;n<r;n+=s)for(let o=0;o<e;o+=s){let m=this.getBlockAverage(i,o,n,s,e,r);this.fillBlock(t,i,o,n,s,e,r,m);}}getBlockAverage(t,e,r,s,i,n){let o=0,m=0,y=0,u=0;for(let c=r;c<Math.min(r+s,n);c++)for(let h=e;h<Math.min(e+s,i);h++){let d=(c*i+h)*4;o+=t[d],m+=t[d+1],y+=t[d+2],u++;}return [Math.round(o/u),Math.round(m/u),Math.round(y/u)]}fillBlock(t,e,r,s,i,n,o,m){let[y,u,c]=m;for(let h=s;h<Math.min(s+i,o);h++)for(let d=r;d<Math.min(r+i,n);d++){let v=(h*n+d)*4;t[v]=e[v]*(1-this.intensity)+y*this.intensity,t[v+1]=e[v+1]*(1-this.intensity)+u*this.intensity,t[v+2]=e[v+2]*(1-this.intensity)+c*this.intensity;}}};});var oe,$e=l(()=>{I();Z();k();oe=class extends g{constructor(t=1){super(t),this.params={filterType:"edgeDetection",intensity:this.intensity};}applyFilter(t,e,r){let s=new Uint8ClampedArray(t.length);for(let n=0;n<t.length;n+=4){let o=t[n]*.299+t[n+1]*.587+t[n+2]*.114;s[n]=s[n+1]=s[n+2]=o,s[n+3]=t[n+3];}let i=this.applySobel(s,e,r);for(let n=0;n<t.length;n+=4)t[n]=t[n]*(1-this.intensity)+i[n]*this.intensity,t[n+1]=t[n+1]*(1-this.intensity)+i[n+1]*this.intensity,t[n+2]=t[n+2]*(1-this.intensity)+i[n+2]*this.intensity;}applySobel(t,e,r){let s=new Uint8ClampedArray(t.length);for(let i=1;i<r-1;i++)for(let n=1;n<e-1;n++){let o=0,m=0;for(let c=-1;c<=1;c++)for(let h=-1;h<=1;h++){let d=((i+c)*e+(n+h))*4,v=(c+1)*3+(h+1),L=t[d];o+=L*He[v],m+=L*Ve[v];}let y=Math.sqrt(o*o+m*m),u=(i*e+n)*4;s[u]=s[u+1]=s[u+2]=p(y),s[u+3]=t[u+3];}return s}};});var me,Xe=l(()=>{C();A();k();me=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"brightness",value:E(e)};}async apply(e,r){let s=r.getImageData(0,0,e.width,e.height),i=s.data,n=this.params.value*2.55;for(let o=0;o<i.length;o+=4)i[o]=p(i[o]+n),i[o+1]=p(i[o+1]+n),i[o+2]=p(i[o+2]+n);r.putImageData(s,0,0);}};});var pe,Ye=l(()=>{C();A();k();pe=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"contrast",value:E(e)};}async apply(e,r){let s=r.getImageData(0,0,e.width,e.height),i=s.data,n=259*(this.params.value+255)/(255*(259-this.params.value));for(let o=0;o<i.length;o+=4)i[o]=p(n*(i[o]-128)+128),i[o+1]=p(n*(i[o+1]-128)+128),i[o+2]=p(n*(i[o+2]-128)+128);r.putImageData(s,0,0);}};});var le,Ge=l(()=>{C();A();k();le=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"saturation",value:E(e)};}async apply(e,r){let s=r.getImageData(0,0,e.width,e.height),i=s.data,n=(this.params.value+100)/100;for(let o=0;o<i.length;o+=4){let m=i[o],y=i[o+1],u=i[o+2],c=.299*m+.587*y+.114*u;i[o]=p(c+n*(m-c)),i[o+1]=p(c+n*(y-c)),i[o+2]=p(c+n*(u-c));}r.putImageData(s,0,0);}};});var ce,Je=l(()=>{C();A();k();ce=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"exposure",value:E(e)};}async apply(e,r){let s=r.getImageData(0,0,e.width,e.height),i=s.data,n=this.params.value/100,o=Math.pow(2,n);for(let m=0;m<i.length;m+=4)i[m]=p(i[m]*o),i[m+1]=p(i[m+1]*o),i[m+2]=p(i[m+2]*o);r.putImageData(s,0,0);}};});var he,Ze=l(()=>{C();A();k();he=class extends f{constructor(e){super();this.type="adjustment";this.params={adjustment:"temperature",value:E(e)};}async apply(e,r){let s=r.getImageData(0,0,e.width,e.height),i=s.data,n=this.params.value/100;for(let o=0;o<i.length;o+=4)n>0?(i[o]=p(i[o]+n*40),i[o+2]=p(i[o+2]-n*40)):(i[o]=p(i[o]+n*40),i[o+2]=p(i[o+2]-n*40));r.putImageData(s,0,0);}};});var et={};rt(et,{ArtistAPhoto:()=>exports.ArtistAPhoto,LicenseError:()=>exports.LicenseError});exports.ArtistAPhoto=void 0;var ge=l(()=>{be();xe();Le();Ee();Pe();B();A();De();Te();Re();Fe();Ue();Se();Be();Ne();qe();_e();Ke();Qe();ze();$e();Xe();Ye();Ge();Je();Ze();exports.ArtistAPhoto=class a{constructor(t){this.state=t,this.operationQueue=new q,this.processor=new _;}static configure(t){x.configure(t);}static async setLicenseKey(t){return x.setLicenseKey(t)}static isLicenseValid(){return x.isLicenseValid()}static getLicenseInfo(){return x.getLicenseInfo()}static clearLicense(){x.clearLicense();}static async refreshLicense(){return x.refreshLicense()}static enableDevMode(){x.enableDevMode();}static isDevMode(){return x.isDevMode()}static async fromUrl(t){x.requireValidLicense();let e=await fe(t),r=N(e),s=new O(e,r);return new a(s)}static async fromFile(t){x.requireValidLicense();let e=await ke(t),r=N(e),s=new O(e,r);return new a(s)}static async fromCanvas(t){x.requireValidLicense();let e=new Image;e.src=t.toDataURL(),await new Promise(i=>e.onload=i);let r=N(e),s=new O(e,r);return new a(s)}static async fromImageElement(t){x.requireValidLicense();let e=N(t),r=new O(t,e);return new a(r)}crop(t){Me(t,this.state.width,this.state.height);let e=new Q(t);return this.operationQueue.enqueue(e),this}resize(t,e,r){Ae(t,e);let s=new z(t,e,r);return this.operationQueue.enqueue(s),this}addText(t){let e=new $(t);return this.operationQueue.enqueue(e),this}addShape(t){let e=new X(t);return this.operationQueue.enqueue(e),this}filter(t,e=1){let r;switch(t){case "grayscale":r=new Y(e);break;case "sepia":r=new G(e);break;case "blur":r=new ee(e);break;case "sharpen":r=new te(e);break;case "vintage":r=new re(e);break;case "invert":r=new ie(e);break;case "vignette":r=new se(e);break;case "posterize":r=new ae(e);break;case "pixelate":r=new ne(e);break;case "edgeDetection":r=new oe(e);break}return this.operationQueue.enqueue(r),this}brightness(t){let e=new me(t);return this.operationQueue.enqueue(e),this}contrast(t){let e=new pe(t);return this.operationQueue.enqueue(e),this}saturation(t){let e=new le(t);return this.operationQueue.enqueue(e),this}exposure(t){let e=new ce(t);return this.operationQueue.enqueue(e),this}temperature(t){let e=new he(t);return this.operationQueue.enqueue(e),this}undo(){return this.operationQueue.undo(),this}redo(){return this.operationQueue.redo(),this}canUndo(){return this.operationQueue.canUndo()}canRedo(){return this.operationQueue.canRedo()}getHistory(){return this.operationQueue.getAllOperations()}reset(){return this.operationQueue.reset(),this}getOriginal(){return this.state.originalImageData}async preview(){let t=this.operationQueue.getActiveOperations();return await this.processor.execute(this.state,t)}async toCanvas(){return await this.preview()}async toBlob(t,e){let r=await this.toCanvas();return await we(r,t,e)}async toDataURL(t,e){let r=await this.toCanvas();return Ce(r,t,e)}async download(t,e,r){let s=await this.toBlob(e,r);Ie(s,t);}};});ge();V();var ve=class{constructor(t){this.workers=[];this.availableWorkers=[];this.workerUrl=null;this.maxWorkers=t||navigator.hardwareConcurrency||4;}createWorker(){if(!this.workerUrl){let e=`
        // Inline worker code would go here
        // For now, this is a placeholder
        self.onmessage = function(e) {
          self.postMessage({ result: e.data.imageData });
        };
      `,r=new Blob([e],{type:"application/javascript"});this.workerUrl=URL.createObjectURL(r);}let t=new Worker(this.workerUrl);return this.workers.push(t),t}async getAvailableWorker(){return this.availableWorkers.length>0?this.availableWorkers.pop():this.workers.length<this.maxWorkers?this.createWorker():new Promise(t=>{let e=setInterval(()=>{this.availableWorkers.length>0&&(clearInterval(e),t(this.availableWorkers.pop()));},10);})}releaseWorker(t){this.availableWorkers.push(t);}async execute(t){let e=await this.getAvailableWorker();return new Promise((r,s)=>{let i=setTimeout(()=>{this.releaseWorker(e),s(new Error("Worker timeout"));},3e4);e.onmessage=n=>{clearTimeout(i),this.releaseWorker(e),r(n.data);},e.onerror=n=>{clearTimeout(i),this.releaseWorker(e),s(n);},e.postMessage(t);})}terminate(){this.workers.forEach(t=>t.terminate()),this.workers=[],this.availableWorkers=[],this.workerUrl&&(URL.revokeObjectURL(this.workerUrl),this.workerUrl=null);}};async function Zr(a){let{ArtistAPhoto:t}=await Promise.resolve().then(()=>(ge(),et));if(typeof a=="string")return t.fromUrl(a);if(a instanceof File)return t.fromFile(a);if(a instanceof HTMLImageElement)return t.fromImageElement(a);if(a instanceof HTMLCanvasElement)return t.fromCanvas(a);throw new Error("Unsupported source type")}exports.WorkerPool=ve;exports.createEditor=Zr;//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map